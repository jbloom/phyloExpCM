<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>phyloExpCM_SiteLikelihoodComparison.py &mdash; phyloExpCM 0.3 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="phyloExpCM 0.3 documentation" href="index.html" />
    <link rel="up" title="Scripts" href="scripts.html" />
    <link rel="next" title="phyloExpCM_multiHyphyRuns.py" href="phyloExpCM_multiHyphyRuns.html" />
    <link rel="prev" title="phyloExpCM_FreqsFromAlignment.py" href="phyloExpCM_FreqsFromAlignment.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_multiHyphyRuns.html" title="phyloExpCM_multiHyphyRuns.py"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_FreqsFromAlignment.html" title="phyloExpCM_FreqsFromAlignment.py"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phyloExpCM 0.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="scripts.html" accesskey="U">Scripts</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="phyloexpcm-sitelikelihoodcomparison-py">
<span id="id1"></span><h1>phyloExpCM_SiteLikelihoodComparison.py<a class="headerlink" href="#phyloexpcm-sitelikelihoodcomparison-py" title="Permalink to this headline">¶</a></h1>
<p>This simple script is designed to compare per-site likelihoods computed with two different substitution models. This is useful if you would like to determine which sites (or types of sites) are described better by one model versus another.</p>
<p>Typically, the per-site likelihoods are listed in files such as those created by running the <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> scripts <a class="reference internal" href="phyloExpCM_ExpModelOptimizeHyphyTree.html#phyloexpcm-expmodeloptimizehyphytree-py"><span class="std std-ref">phyloExpCM_ExpModelOptimizeHyphyTree.py</span></a> or <a class="reference internal" href="phyloExpCM_optimizeHyphyTree.html#phyloexpcm-optimizehyphytree-py"><span class="std std-ref">phyloExpCM_optimizeHyphyTree.py</span></a> with the <em>persitelikelihoods</em> option.</p>
<p>You can optionally compare the per-site likelihood performance to site classifications based on relative solvent accessibility (RSA) or secondary structure computed using <a class="reference external" href="http://swift.cmbi.ru.nl/gv/dssp/">DSSP</a>. This will require you to have a crystal structure for your protein that you can analyze with <a class="reference external" href="http://swift.cmbi.ru.nl/gv/dssp/">DSSP</a>.</p>
<p>This script requires <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> and <a class="reference external" href="http://matplotlib.org/">matplotlib</a>.</p>
<p>To run the script, create an input file of the format described below. Then run the script followed by the input file, as in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">phyloExpCM_SiteLikelihoodComparison</span><span class="o">.</span><span class="n">py</span> <span class="n">infile</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<div class="section" id="format-of-the-input-file">
<h2>Format of the input file<a class="headerlink" href="#format-of-the-input-file" title="Permalink to this headline">¶</a></h2>
<p>The input file specifies <cite>key</cite> / <cite>value</cite> pairs on individual lines in the format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">key1</span> <span class="n">value1</span>
<span class="n">key2</span> <span class="n">value2</span>
</pre></div>
</div>
<p>Blank lines or lines
that begin with # are ignored (i.e. as comment lines).</p>
<p>The input file should contain the following keys:</p>
<ul>
<li><p class="first"><em>sitelikelihoodfiles</em> : This key should be followed by the names of two existing files listing the per-site likelihoods for all sites in the gene. The names of the files cannot contain spaces. The must list exactly the same sites. Typically, these are the files created with the <em>persitelikelihoods</em> option of <a class="reference internal" href="phyloExpCM_ExpModelOptimizeHyphyTree.html#phyloexpcm-expmodeloptimizehyphytree-py"><span class="std std-ref">phyloExpCM_ExpModelOptimizeHyphyTree.py</span></a> or <a class="reference internal" href="phyloExpCM_optimizeHyphyTree.html#phyloexpcm-optimizehyphytree-py"><span class="std std-ref">phyloExpCM_optimizeHyphyTree.py</span></a>. Here is an example of the format (the first line is a header, all other lines list sites and then likelihoods):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#SITE   SITE_LOG_LIKELIHOODS</span>
<span class="mi">1</span>   <span class="o">-</span><span class="mf">4.792906363107919</span>
<span class="mi">2</span>   <span class="o">-</span><span class="mf">15.89808216031635</span>
<span class="mi">3</span>   <span class="o">-</span><span class="mf">17.19022748421175</span>
</pre></div>
</div>
</li>
<li><p class="first"><em>modelnames</em> : This should be the names of the two models using to produce the two files specified by <em>sitelikelihoodsfiles</em>. These names cannot contain spaces, but they can contain underscores which are converted to spaces in the displayed results.</p>
</li>
<li><p class="first"><em>outfileprefix</em> : The prefix of the output files created by this script (see <a class="reference internal" href="#output-files">Output files</a>). Set to <em>None</em> if you don&#8217;t want any prefix and just want the base names described in <a class="reference internal" href="#output-files">Output files</a>.</p>
</li>
<li><p class="first"><em>dsspfile</em> : is an option that allows you to compare the observed site entropies and preferences to the relative solvent accessibility (RSA) and the secondary structure for the sites. This will only be useful if a crystal structure for your protein is available. You can then use the <a class="reference external" href="http://swift.cmbi.ru.nl/gv/dssp/">DSSP</a> webserver to calculate the secondary structures and the RSAs. If you do not want to use this option, just set <em>dsspfile</em> to <em>None</em>. If you do want to use this option, then run <a class="reference external" href="http://swift.cmbi.ru.nl/gv/dssp/">DSSP</a> on your protein structure – this script is tested against output from the <a class="reference external" href="http://swift.cmbi.ru.nl/gv/dssp/">DSSP</a> webserver, but should probably work on output from the standalone too. Then save the <a class="reference external" href="http://swift.cmbi.ru.nl/gv/dssp/">DSSP</a> output in a text file, and specify the path to that file as the value for <em>dsspfile</em>. This script does not currently have a robust ability to parse the <a class="reference external" href="http://swift.cmbi.ru.nl/gv/dssp/">DSSP</a> output, so you have to do some careful checks. In particular, you must make sure that residue numbers in the PDB file exactly match the residue numbering scheme used for the rest of this analysis (i.e. the same residue numbers found in sitepreferences, and that none of the residue numbers contain letter suffixes (such as 24A) as is sometimes the case in PDB files. It is not necessary that all of the residues be present in the PDB. If there are multiple PDB chains, you can specify them using the <em>dsspchain</em> option. <a class="reference external" href="http://swift.cmbi.ru.nl/gv/dssp/">DSSP</a> only calculates absolute accessible surface areas (ASAs); the RSAs are computed by normalizing by the maximum ASAs given by <a class="reference external" href="http://www.plosone.org/article/info:doi/10.1371/journal.pone.0080635">Tien et al, 2013</a>.</p>
</li>
<li><p class="first"><em>dsspchain</em> : is an option that is only meaningful if <em>dsspfile</em> is set to a value other than <em>None</em>. In this case, it should specify the chain in the PDB file that we want to use. If there is only one chain, you can set this option to <em>None</em>.</p>
</li>
</ul>
</div>
<div class="section" id="example-input-file">
<h2>Example input file<a class="headerlink" href="#example-input-file" title="Permalink to this headline">¶</a></h2>
<p>Here is an example input file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># input file for running script phyloExpCM_SiteLikelihoodComparison.py for phyloExpCM_SiteLikelihoodComparison</span>
<span class="n">sitelikelihoodfiles</span> <span class="n">codonmodel_optimized_trees</span><span class="o">/</span><span class="n">Tree</span><span class="o">-</span><span class="n">GY94_Model</span><span class="o">-</span><span class="n">fitbetaHalpernBruno</span><span class="o">/</span><span class="n">sitelikelihoods</span><span class="o">.</span><span class="n">txt</span> <span class="n">codonmodel_optimized_trees</span><span class="o">/</span><span class="n">Tree</span><span class="o">-</span><span class="n">GY94_Model</span><span class="o">-</span><span class="n">GY94_CF3x4_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">gamma4_rates</span><span class="o">-</span><span class="n">gamma4</span><span class="o">/</span><span class="n">sitelikelihoods</span><span class="o">.</span><span class="n">txt</span>
<span class="n">modelnames</span> <span class="n">experimental</span> <span class="n">GY94</span>
<span class="n">dsspfile</span> <span class="mi">1</span><span class="n">XPB_renumbered</span><span class="o">.</span><span class="n">dssp</span>
<span class="n">dsspchain</span> <span class="kc">None</span>
<span class="n">outfileprefix</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="section" id="output-files">
<h2>Output files<a class="headerlink" href="#output-files" title="Permalink to this headline">¶</a></h2>
<p>The output of this script is two PDF plots and a text file. These files give the site likelihood computed by model 1 (the first entry in <em>sitelikelihoodsfiles</em> and <em>modelnames</em>) minus the site likelihood computed by model 2 (the second entry in <em>sitelikelhoodsfiles</em> and <em>modelnames</em>).</p>
<p>These files all have the prefix specified by <em>outfileprefix</em> followed by the following to suffixes:</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal"><span class="pre">sitelikelihoodcomparison_bySS.pdf</span></code> : sites are categorized according to secondary structure in this PDF plot.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">sitelikelihoodcomparison_byRSA.pdf</span></code> : sites are categorized according to RSA (relative solvent accessibility) in this PDF plot.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">sitelikelihoods.txt</span></code> : text file listing per-site likelihoods and differences between them for the two models. These are sorted according to the differences in site likelihoods. Here are the first few lines of such a file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>#SITE   experimental_likelihood_minus_GY94_likelihood   experimental_likelihood GY9    4_likelihood secondary_structure relative_solvent_accessibility
33  -17.8153    -94.7358    -76.9205    helix   $&lt; 0.33$
236 -16.6144    -77.372     -60.7576    loop    $&lt; 0.33$
102 -15.1698    -75.4882    -60.3184    loop    $0.33 - 0.67$
162 -12.0474    -102.512    -90.4646    loop    $&lt; 0.33$
237 -10.3165    -87.4672    -77.1507    loop    $0.33 - 0.67$
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p>Here are examples of the two plots. The y-axis labels show the site category (top line of label) and the number of sites that fall into that category (bottom line of label).</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/example_2014Analysis_lactamase_sitelikelihoodcomparison_byRSA.jpg"><img alt="example_2014Analysis_lactamase_sitelikelihoodcomparison_byRSA.jpg" src="_images/example_2014Analysis_lactamase_sitelikelihoodcomparison_byRSA.jpg" style="width: 45%;" /></a>
<p class="caption"><span class="caption-text">Example of the <code class="docutils literal"><span class="pre">sitelikelihoodcomparison_byRSA.pdf</span></code> plot.</span></p>
</div>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/example_2014Analysis_lactamase_sitelikelihoodcomparison_bySS.jpg"><img alt="example_2014Analysis_lactamase_sitelikelihoodcomparison_bySS.jpg" src="_images/example_2014Analysis_lactamase_sitelikelihoodcomparison_bySS.jpg" style="width: 45%;" /></a>
<p class="caption"><span class="caption-text">Example of the <code class="docutils literal"><span class="pre">sitelikelihoodcomparison_bySS.pdf</span></code> plot.</span></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">phyloExpCM_SiteLikelihoodComparison.py</a><ul>
<li><a class="reference internal" href="#format-of-the-input-file">Format of the input file</a></li>
<li><a class="reference internal" href="#example-input-file">Example input file</a></li>
<li><a class="reference internal" href="#output-files">Output files</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="phyloExpCM_FreqsFromAlignment.html"
                        title="previous chapter">phyloExpCM_FreqsFromAlignment.py</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="phyloExpCM_multiHyphyRuns.html"
                        title="next chapter">phyloExpCM_multiHyphyRuns.py</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/phyloExpCM_SiteLikelihoodComparison.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_multiHyphyRuns.html" title="phyloExpCM_multiHyphyRuns.py"
             >next</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_FreqsFromAlignment.html" title="phyloExpCM_FreqsFromAlignment.py"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phyloExpCM 0.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="scripts.html" >Scripts</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Jesse D. Bloom.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.
    </div>
  </body>
</html>