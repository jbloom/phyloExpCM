<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>phylodistances Module &mdash; phyloExpCM 0.3 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="phyloExpCM 0.3 documentation" href="index.html" />
    <link rel="up" title="Python modules in phyloExpCM" href="modules.html" />
    <link rel="next" title="Acknowledgements" href="acknowledgements.html" />
    <link rel="prev" title="plot Module" href="plot.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="acknowledgements.html" title="Acknowledgements"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot.html" title="plot Module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phyloExpCM 0.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" accesskey="U">Python modules in phyloExpCM</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-phylodistances">
<span id="phylodistances-module"></span><h1><code class="docutils literal"><span class="pre">phylodistances</span></code> Module<a class="headerlink" href="#module-phylodistances" title="Permalink to this headline">¶</a></h1>
<p>Module for analyzing pairwise distances generated by <a href="#id1"><span class="problematic" id="id2">``</span></a>phyloExpCM_optimizeHyphyTree.py.</p>
<p>Written by Jesse Bloom.</p>
<div class="section" id="functions-defined-in-this-module">
<h2>Functions defined in this module<a class="headerlink" href="#functions-defined-in-this-module" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><em>ParsePairwiseDistances</em> : parses pairwise distances</li>
<li><em>YearVersusDistance</em> : parses year versus distance</li>
</ul>
<dl class="function">
<dt id="phylodistances.ParsePairwiseDistances">
<code class="descclassname">phylodistances.</code><code class="descname">ParsePairwiseDistances</code><span class="sig-paren">(</span><em>distancesfile</em>, <em>equaltol=0.001</em><span class="sig-paren">)</span><a class="headerlink" href="#phylodistances.ParsePairwiseDistances" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses pairwise distances between sequences.</p>
<p><em>distancesfile</em> should give the name of an existing file containing pairwise distances
between sequences. Typically this would be the type of file produced by 
<code class="docutils literal"><span class="pre">phyloExpCM_optimizeHyphyTree.py</span></code>. Each line should contain three entries delimited by
tabs. The first entry is the name of sequence 1, the second entry is the name of sequence
2, and the third entry is the numerical pairwise distance between them. Here are a few example
lines:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">1983.14</span><span class="n">_STRAIN_A</span><span class="o">/</span><span class="n">Kentucky</span><span class="o">/</span><span class="n">UR06</span><span class="o">-</span><span class="mi">0372</span><span class="o">/</span><span class="mi">2007</span><span class="n">_HOST_Human_SUBTYPE_H1N1_COUNTRY_USA_n1</span> <span class="mf">1957.50</span><span class="n">_STRAIN_A</span><span class="o">/</span><span class="n">Baylor</span><span class="o">/</span><span class="mi">4052</span><span class="o">/</span><span class="mi">1981</span><span class="n">_HOST_Human_SUBTYPE_H1N1_COUNTRY_USA_n1</span>    <span class="mf">2.109830328352041</span>
<span class="mf">1983.14</span><span class="n">_STRAIN_A</span><span class="o">/</span><span class="n">Kentucky</span><span class="o">/</span><span class="n">UR06</span><span class="o">-</span><span class="mi">0372</span><span class="o">/</span><span class="mi">2007</span><span class="n">_HOST_Human_SUBTYPE_H1N1_COUNTRY_USA_n1</span> <span class="mf">1972.50</span><span class="n">_STRAIN_A</span><span class="o">/</span><span class="n">Nanchang</span><span class="o">/</span><span class="mi">25</span><span class="o">/</span><span class="mi">1996</span><span class="n">_HOST_Human_SUBTYPE_H1N1_COUNTRY_China_n1</span>  <span class="mf">0.8163390477352853</span>
</pre></div>
</div>
<p>This function returns a dictionary keyed by 2-tuples giving the sequence names. For each 
sequence pair, two 2-tuple keys are generated: <em>(seq1, seq2)</em>, and <em>(seq2, seq1)</em>, both
with the pairwise distance as the value.</p>
<p>Error checking is performed to make sure that any duplicate entries have the same distance
within a tolerance of <em>equaltol</em>.</p>
</dd></dl>

<dl class="function">
<dt id="phylodistances.YearVersusDistance">
<code class="descclassname">phylodistances.</code><code class="descname">YearVersusDistance</code><span class="sig-paren">(</span><em>distancesfile</em>, <em>startseq</em>, <em>include_matches</em>, <em>exclude_matches</em><span class="sig-paren">)</span><a class="headerlink" href="#phylodistances.YearVersusDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets list of years of separation versus distances</p>
<ul>
<li><p class="first"><em>distancesfile</em> should give the name of an existing file containing pairwise distances
between sequences. Typically this would be the type of file produced by 
<code class="docutils literal"><span class="pre">phyloExpCM_optimizeHyphyTree.py</span></code>. Each line should contain three entries delimited by
tabs. The first entry is the name of sequence 1, the second entry is the name of sequence
2, and the third entry is the numerical pairwise distance between them. Here are a few example
lines:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">1983.14</span><span class="n">_STRAIN_A</span><span class="o">/</span><span class="n">Kentucky</span><span class="o">/</span><span class="n">UR06</span><span class="o">-</span><span class="mi">0372</span><span class="o">/</span><span class="mi">2007</span><span class="n">_HOST_Human_SUBTYPE_H1N1_COUNTRY_USA_n1</span> <span class="mf">1957.50</span><span class="n">_STRAIN_A</span><span class="o">/</span><span class="n">Baylor</span><span class="o">/</span><span class="mi">4052</span><span class="o">/</span><span class="mi">1981</span><span class="n">_HOST_Human_SUBTYPE_H1N1_COUNTRY_USA_n1</span>    <span class="mf">2.109830328352041</span>
<span class="mf">1983.14</span><span class="n">_STRAIN_A</span><span class="o">/</span><span class="n">Kentucky</span><span class="o">/</span><span class="n">UR06</span><span class="o">-</span><span class="mi">0372</span><span class="o">/</span><span class="mi">2007</span><span class="n">_HOST_Human_SUBTYPE_H1N1_COUNTRY_USA_n1</span> <span class="mf">1972.50</span><span class="n">_STRAIN_A</span><span class="o">/</span><span class="n">Nanchang</span><span class="o">/</span><span class="mi">25</span><span class="o">/</span><span class="mi">1996</span><span class="n">_HOST_Human_SUBTYPE_H1N1_COUNTRY_China_n1</span>  <span class="mf">0.8163390477352853</span>
</pre></div>
</div>
<p>Each sequence name should begin with a number giving the year of isolation, followed by an 
underscore, as in the example above. This number is the year assigned to the sequence.</p>
</li>
<li><p class="first"><em>startseq</em> should be the name of a sequence listed in <em>distancesfile</em>. Typically this would be
a sequence for which you have computed many pairwise distances to other sequences. For instance,
for the example above you might make 
<em>startseq = &#8220;1983.14_STRAIN_A/Kentucky/UR06-0372/2007_HOST_Human_SUBTYPE_H1N1_COUNTRY_USA_n1&#8221;.
An exception is raised if *startseq</em> is not found at least once in <em>distancesfile</em>.</p>
</li>
<li><p class="first"><em>include_matches</em> is a list of <code class="docutils literal"><span class="pre">re</span></code> regular expression objects. We consider distances from <em>startseq</em>
to all other sequences with names that <strong>do</strong> match with at least one of these objects.</p>
</li>
<li><p class="first"><em>exclude_matches</em> is a list of <code class="docutils literal"><span class="pre">re</span></code> regular expression objects. We do <strong>not</strong> consider distances
from <em>startseq</em> to any other sequence with names that match with at least one of these objects.
Being present in <em>exclude_matches</em> overrides being present in <em>include_matches</em></p>
</li>
</ul>
<p>The return value is a list of tuples of the form <em>(yearseparation, distance, startseq, otherseq)</em>. There
is an entry for all sequences in <em>distancesfile</em> that are in <em>include_matches</em> and are <strong>not</strong> present
in <em>exclude_matches</em>. There is also always an entry for <em>otherseq</em> equal to <em>startseq</em>. <em>yearseparation</em>
is a number giving the separation of the sequence dates in years (year of <em>otherseq</em> minus year of
<em>startseq</em>), and <em>distance</em> is the distance specified in <em>distancesfile</em>.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="docutils literal"><span class="pre">phylodistances</span></code> Module</a><ul>
<li><a class="reference internal" href="#functions-defined-in-this-module">Functions defined in this module</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="plot.html"
                        title="previous chapter"><code class="docutils literal"><span class="pre">plot</span></code> Module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="acknowledgements.html"
                        title="next chapter">Acknowledgements</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/phylodistances.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="acknowledgements.html" title="Acknowledgements"
             >next</a> |</li>
        <li class="right" >
          <a href="plot.html" title="plot Module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phyloExpCM 0.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >Python modules in phyloExpCM</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Jesse D. Bloom.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.
    </div>
  </body>
</html>