<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2014 analysis of H1 influenza HAs descended from 1918 virus &mdash; phyloExpCM 0.3 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="phyloExpCM 0.3 documentation" href="index.html" />
    <link rel="up" title="Examples" href="examples.html" />
    <link rel="next" title="Python modules in phyloExpCM" href="modules.html" />
    <link rel="prev" title="2014 analysis of influenza NP with stringency parameter" href="example_2014Analysis_Influenza_NP_Human_1918_Descended_withbeta.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Python modules in phyloExpCM"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="example_2014Analysis_Influenza_NP_Human_1918_Descended_withbeta.html" title="2014 analysis of influenza NP with stringency parameter"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phyloExpCM 0.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" accesskey="U">Examples</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="analysis-of-h1-influenza-has-descended-from-1918-virus">
<h1><a class="toc-backref" href="#id5">2014 analysis of H1 influenza HAs descended from 1918 virus</a><a class="headerlink" href="#analysis-of-h1-influenza-has-descended-from-1918-virus" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#analysis-of-h1-influenza-has-descended-from-1918-virus" id="id5">2014 analysis of H1 influenza HAs descended from 1918 virus</a><ul>
<li><a class="reference internal" href="#overview" id="id6">Overview</a></li>
<li><a class="reference internal" href="#software-used" id="id7">Software used</a></li>
<li><a class="reference internal" href="#input-files" id="id8">Input files</a></li>
<li><a class="reference internal" href="#running-the-analysis" id="id9">Running the analysis</a></li>
<li><a class="reference internal" href="#steps-in-the-analysis" id="id10">Steps in the analysis</a><ul>
<li><a class="reference internal" href="#construction-of-sequence-sets" id="id11">Construction of sequence sets</a></li>
<li><a class="reference internal" href="#construction-of-phylogenetic-trees" id="id12">Construction of phylogenetic trees</a></li>
<li><a class="reference internal" href="#computing-evolutionary-equilibrium-frequencies" id="id13">Computing evolutionary equilibrium frequencies</a></li>
<li><a class="reference internal" href="#correlations-between-preferences-and-evolutionary-conservation" id="id14">Correlations between preferences and evolutionary conservation</a></li>
<li><a class="reference internal" href="#analysis-of-tree-with-various-substitution-models" id="id15">Analysis of tree with various substitution models</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>This is a description of the analysis in <a class="reference external" href="http://dx.doi.org/10.7554/eLife.03300">The inherent mutational tolerance and antigenic evolvability of influenza hemagglutinin</a>.</p>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id6">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This is an analysis of influenza A virus H1 hemagglutinins (HAs) from human and swine that are descended from a common ancestor closely related the HA of the 1918 virus. This analysis constructs phylogenies of these sequences and analyzes them with standard and experimentally determined codon substitution models.</p>
<p>This analysis was performed by <a class="reference external" href="http://research.fhcrc.org/bloom/en.html">Jesse Bloom</a>.</p>
<p>Much of the analysis itself is performed using <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a>, which is run by <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> using the scripts detailed in the <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a>.</p>
<p>The code, data, and results from the analysis are in the <code class="docutils literal"><span class="pre">./examples/2014Analysis_Influenza_H1_HA/</span></code> subdirectory in the main <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> package directory. This subdirectory contains the necessary input files (see <a class="reference internal" href="#input-files">Input files</a>) for running the analysis. It also contains a master script (<code class="docutils literal"><span class="pre">run_analysis.py</span></code>) that can be used to regenerate the analysis with the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">run_analysis</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>provided that you have installed the software described in <a class="reference internal" href="#software-used">Software used</a>.</p>
</div>
<div class="section" id="software-used">
<h2><a class="toc-backref" href="#id7">Software used</a><a class="headerlink" href="#software-used" title="Permalink to this headline">¶</a></h2>
<p>The analysis was performed using the following software on the Fred Hutchinson computer cluster using the following Linux distribution:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Linux</span> <span class="n">version</span> <span class="mf">3.5</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">43</span><span class="o">-</span><span class="n">generic</span> <span class="p">(</span><span class="n">buildd</span><span class="nd">@roseapple</span><span class="p">)</span> <span class="p">(</span><span class="n">gcc</span> <span class="n">version</span> <span class="mf">4.6</span><span class="o">.</span><span class="mi">3</span> <span class="p">(</span><span class="n">Ubuntu</span><span class="o">/</span><span class="n">Linaro</span> <span class="mf">4.6</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="n">ubuntu5</span><span class="p">)</span> <span class="p">)</span> <span class="c1">#66~precise1-Ubuntu SMP Thu Oct 24 14:52:23 UTC 2013</span>
</pre></div>
</div>
<p>In order to replicate the analysis, you will need to use Linux or Mac OS X, and install the software listed below.</p>
<p>The specific versions of software used are specified. Other versions will likely work as well, but this has not been confirmed.</p>
<ul>
<li><p class="first"><a class="reference external" href="http://www.python.org/">Python</a> (version 2.7.3)</p>
</li>
<li><p class="first"><a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> (specifically, <a class="reference external" href="https://github.com/jbloom/phyloExpCM/tree/v0.32">phyloExpCM version 0.32</a>).</p>
</li>
<li><p class="first"><a class="reference external" href="http://www.numpy.org/">numpy</a> (version 1.6.1)</p>
</li>
<li><p class="first"><a class="reference external" href="http://matplotlib.org/">matplotlib</a> (version 1.3.1).</p>
</li>
<li><p class="first"><a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> (specifically, <a class="reference external" href="https://github.com/jbloom/mapmuts/tree/v1.01">mapmuts version 1.01</a>)</p>
</li>
<li><p class="first"><a class="reference external" href="http://biopython.org/wiki/Main_Page">Biopython</a> (version 1.5.8)</p>
</li>
<li><p class="first"><a class="reference external" href="http://emboss.sourceforge.net/download/">EMBOSS needle</a> (version 6.6.0). The executable with the name <code class="docutils literal"><span class="pre">needle</span></code> is expected to be in the current search path.</p>
</li>
<li><p class="first"><a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a> (version 7.7.6). The executable with the name <code class="docutils literal"><span class="pre">raxmlHPC-SSE3</span></code> is expected to be in the current search path. This is the SSE3 version, and was built using the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="o">-</span><span class="n">f</span> <span class="n">Makefile</span><span class="o">.</span><span class="n">SSE3</span><span class="o">.</span><span class="n">gcc</span>
</pre></div>
</div>
<p>and then copying the executable into the search path.</p>
</li>
<li><p class="first"><a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a> (version 1.4) was used for the visual identification of outliers from the molecular clock and to root trees based on date-stamping.</p>
</li>
<li><p class="first"><a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a> (version 1.4.0) was used to open tree files for annotation, visualization, and saving of images.</p>
</li>
<li><p class="first"><a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> (version 1.00 201306.18) was used to build phylogenetic trees. The executable with the name <code class="docutils literal"><span class="pre">codonphyml</span></code> is expected to be in the current search path. This executable was compiled with the <em>omp</em> options to make it multi-threaded.</p>
</li>
<li><p class="first"><a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> (version HYPHY 2.220131214beta(MP) for Linux on x86_64) was used to optimize the branches and compute the likelihoods under the different models. The multiprocessor (<code class="docutils literal"><span class="pre">HYPHYMP</span></code>) version of the executable was used. To install this, the following commands were run in the unzipped <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> source code directory after download:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cmake</span> <span class="o">-</span><span class="n">DINSTALL_PREFIX</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">jbloom</span><span class="o">/.</span><span class="n">local</span><span class="o">/</span> <span class="o">.</span>
<span class="n">make</span> <span class="n">MP2</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
</li>
<li><p class="first">This analysis was run on the FHCRC scientific computing cluster using <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> (version 2.6.2), and requires <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> to be installed to run as currently implemented. If you don&#8217;t want to use <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a>, all you need to do is modify the main <code class="docutils literal"><span class="pre">run_analysis.py</span></code> script to not submit any jobs via <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a>. The use of <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> in the current version simply allows more processors to be used simultaneously and so speeds up the analysis.</p>
</li>
<li><p class="first"><a class="reference external" href="http://www.imagemagick.org/script/convert.php">ImageMagick convert</a> 6.6.9-7 2012-08-17 was used to convert PDF files to JPGs.</p>
</li>
<li><p class="first"><a class="reference external" href="http://weblogo.threeplusone.com/">weblogo</a> (version 3.3) was used to make the sequence logo plot.</p>
</li>
<li><p class="first"><a class="reference external" href="http://pybrary.net/pyPdf/">PyPdf</a> (version 1.13) was used to make overlays on the sequence logo plot.</p>
</li>
</ul>
</div>
<div class="section" id="input-files">
<h2><a class="toc-backref" href="#id8">Input files</a><a class="headerlink" href="#input-files" title="Permalink to this headline">¶</a></h2>
<p>Here are the input files that are necessary to repeat the analysis. These are the names assigned with the <code class="docutils literal"><span class="pre">./examples/2014Analysis_Influenza_H1_HA/</span></code> subdirectory of the main <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> package.</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">run_analysis.py</span></code> is a <a class="reference external" href="http://www.python.org/">Python</a> script that will perform the analysis assuming that you have all of the appropriate software (see <a class="reference internal" href="#software-used">Software used</a>) and input files. To run this script, use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">run_analysis</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>at the command line.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">WSN-HA.fasta</span></code> is the coding DNA sequence for the A/WSN/1933 (H1N1) HA as taken from reverse-genetics plasmid pHW184-HA.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">H1_HAseqs.fasta</span></code> is the set of all full-length influenza A HA coding DNA sequences of subtype H1 (excluding lab-adapted strains) as downloaded from the <a class="reference external" href="http://www.ncbi.nlm.nih.gov/genomes/FLU/FLU.html">Influenza Virus Resource</a> on March-29-2014.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">parse_H1_HumanSwine.py</span></code> is a <a class="reference external" href="http://www.python.org/">Python</a> scripts that extracts and aligns the HA sequences in <code class="docutils literal"><span class="pre">H1_HAseqs.fasta</span></code></p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">JVI_82_8947_Anomalies.txt</span></code> is a list of the strain names for the sequences identified as anomalous (either frozen in time or recombinant) in Appendices 1 and 2 of <cite>Krasnitz et al, 2008</cite>.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">JDB_Anomalies.txt</span></code> is a list of strain names that appear to be anomalous based on their strong violation of the molecular clock. These sequences are probably mis-annotated in the database, come from non-standard lineages (for examples a swine H3N2 isolated from humans), are reassortants, are extensively lab adapted and so deviate from the molecular clock due to large numbers of adaptation mutations, or are simply valid H1N1 sequences that don&#8217;t fall into the 1918 descended human or swine lineages.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">mutationrates.txt</span></code> is a file giving the nucleotide mutation rates for the influenza polymerase as described in <a class="reference external" href="http://biorxiv.org/content/early/2014/03/05/002899">Bloom 2014</a>. Specifically, in that reference the mutation rates were determined as:</p>
<blockquote>
<div><ul class="simple">
<li>AG, TC : <span class="math">\(2.4 \times 10^{-5}\)</span></li>
<li>GA, CT : <span class="math">\(2.3 \times 10^{-5}\)</span></li>
<li>AC, TG : <span class="math">\(9.0 \times 10^{-6}\)</span></li>
<li>CA, GT : <span class="math">\(9.4 \times 10^{-6}\)</span></li>
<li>AT, TA : <span class="math">\(3.0 \times 10^{-6}\)</span></li>
<li>GC, CG : <span class="math">\(1.9 \times 10^{-6}\)</span></li>
</ul>
</div></blockquote>
<p>There are six experimentally determined mutation rates, but in order for the overall substitution model to be reversible, the mutation rates must satisfy <span class="math">\(R_{C \rightarrow T} = \frac{R_{A \rightarrow G} \times R_{C \rightarrow A}}{R_{A \rightarrow C}}\)</span> as described in the <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a> to <code class="docutils literal"><span class="pre">phyloExpCM_OptimizeDetectSelectionHyphy.py</span></code>. To satisfy this constraint will conforming to the experimentally measured values, we set the rates for A to C and C to A mutations equal to their average, and the same for A to G and G to A. This seems justified as these pairs of rates are nearly equal in the experimentally determined values. This gives the contents of <code class="docutils literal"><span class="pre">mutationrates.txt</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AC</span> <span class="mf">9.2e-6</span>
<span class="n">AG</span> <span class="mf">2.35e-5</span>
<span class="n">AT</span> <span class="mf">3.0e-6</span>
<span class="n">CA</span> <span class="mf">9.2e-6</span>
<span class="n">CG</span> <span class="mf">1.9e-6</span>
</pre></div>
</div>
</li>
<li><p class="first">The site-specific amino-acid preferences for the WSN HA as inferred using <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> and described as part of the <a class="reference external" href="http://jbloom.github.io/mapmuts/example_WSN_HA_2014Analysis.html">mapmuts analysis of the WSN HA from 2014</a>. These are the preferences inferred with the <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> script <code class="docutils literal"><span class="pre">mapmuts_inferpreferences.py</span></code>. The specific files are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">combined_amino_acid_preferences.txt</span></code> : combined data from all three experimental replicates.</li>
<li><code class="docutils literal"><span class="pre">replicate_1_amino_acid_preferences.txt</span></code> : data from first experimental replicate.</li>
<li><code class="docutils literal"><span class="pre">replicate_2_amino_acid_preferences.txt</span></code> : data from second experimental replicate.</li>
<li><code class="docutils literal"><span class="pre">replicate_3_amino_acid_preferences.txt</span></code> : data from third experimental replicate.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">./PDB_structure/</span></code> : subdirectory containing the results of analyzing the crystal structure of HA. Specific input files in this directory:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">1RVX.pdb</span></code> is the crystal structure <a class="reference external" href="http://www.pdb.org/pdb/explore/explore.do?structureId=1RVX">1RVX</a> (downloaded from the Protein Data Bank) of the HA from A/PR/8/1934 (H1N1). This is the crystallized HA closest in identity to the WSN HA.</li>
<li><code class="docutils literal"><span class="pre">1RVX_trimer.pdb</span></code> is a version of <code class="docutils literal"><span class="pre">1RVX.pdb</span></code> that has been manually edited to contain only one trimer (chains A through F). The original <code class="docutils literal"><span class="pre">1RVX.pdb</span></code> contains two trimers in the asymmetric unit.</li>
<li><code class="docutils literal"><span class="pre">1RVX_trimer_renumbered.pdb</span></code> is a version of <code class="docutils literal"><span class="pre">1RVX_trimer.pdb</span></code> that has been renumbered with <a class="reference external" href="http://dicsoft2.physics.iisc.ernet.in/pdbgoodies/inputpage.html">PDB Goodies</a> and so manual touch-up so that the numbering matches sequential 1, 2, ... numbering of the WSN HA sequence. The HA1 and HA2 chains have been merged into single chains (A, B, and C) and these chains are now numbered so that residue <em>r</em> corresponds to residue <em>r</em> in sequential numbering of the WSN HA sequence. Overall, this renumbered PDB contains 483 residues in each of the three HA chains, of which 438 are exact matches with the corresponding position in the WSN HA protein.</li>
<li><code class="docutils literal"><span class="pre">1RVX_trimer_renumbered.dssp</span></code> is a text file containing the results of running the <a class="reference external" href="http://www.cmbi.ru.nl/hsspsoap/">DSSP webserver</a> on <code class="docutils literal"><span class="pre">1RVX_trimer_renumbered.pdb</span></code> to determine the secondary structure and solvent accessibility of residues. The residues in this file match sequential 1, 2, ... numbering of the WSN HA protein sequence.</li>
<li><code class="docutils literal"><span class="pre">sequential_to_H3.txt</span></code> is a file that converts between the sequential 1, 2, ... numbering of the WSN HA and the H3 numbering scheme as used in PDB <a class="reference external" href="http://www.pdb.org/pdb/explore/explore.do?structureId=4HMG">4HMG</a>. This conversion was done using <a class="reference external" href="https://github.com/jbloom/HA_numbering">HA_numbering</a>. The file contains comma-separated lines with the first entry giving the sequential number and the second giving the H3 number. For the H3 number, numbers alone indicate the HA1 chain and numbers followed by HA2 indicate the HA2 chain.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="running-the-analysis">
<h2><a class="toc-backref" href="#id9">Running the analysis</a><a class="headerlink" href="#running-the-analysis" title="Permalink to this headline">¶</a></h2>
<p>The analysis in this directory can be repeated simply by running the master script <code class="docutils literal"><span class="pre">run_analysis.py</span></code> from the command line with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">run_analysis</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>or running it using <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sbatch</span> <span class="n">run_analysis</span><span class="o">.</span><span class="n">sbatch</span>
</pre></div>
</div>
<p>Other than the files delineated under <a class="reference internal" href="#input-files">Input files</a>, all data files in this directory can be re-generated with this command. However, the analysis approach does involve a few manual steps with <a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a> and <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a> to create nicely formatted and annotated tree images from the raw tree files produced by the script. These manual steps are indicated below.</p>
<p>There is a variable called <em>use_existing_output</em> that is hardcoded into the beginning of this script. This variable is currently set to <em>True</em>, which means that if output already exists it is <strong>not</strong> overwritten and regenerated. If you want to regenerate the output (such as after changing input files or altering analysis parameters), then either manually delete the old output or change <em>use_existing_output</em> to <em>False</em> to force the script to overwrite old output. This script does <strong>not</strong> automatically test for dependencies among files, so if you change a file but keep <em>use_existing_output</em> to <em>True</em>, then you need to manually remove any old files with dependencies.</p>
<p>Note that <code class="docutils literal"><span class="pre">run_analysis.py</span></code> uses multiple CPUs to speed up some of the analyses. If you don&#8217;t have as many CPUs on your system, you might want to check that you are not overloading the system &#8211; you can avoid this by using fewer CPUs, which will require you to manually modify the <code class="docutils literal"><span class="pre">run_analysis.py</span></code> script.</p>
<p>Note that <code class="docutils literal"><span class="pre">run_analysis.py</span></code> uses <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> by default to run some of its subsidiary programs &#8211; if you don&#8217;t want to do this, set the <em>use_sbatch</em> option to <em>False</em> within the program.</p>
</div>
<div class="section" id="steps-in-the-analysis">
<h2><a class="toc-backref" href="#id10">Steps in the analysis</a><a class="headerlink" href="#steps-in-the-analysis" title="Permalink to this headline">¶</a></h2>
<p>Here are the steps in the analysis. The command for each step is shown, but most of these commands (with the exception of some manual formatting of tree images with <a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a> and <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>) are run automatically by the main <code class="docutils literal"><span class="pre">run_analysis.py</span></code> script if you are using that.</p>
<div class="section" id="construction-of-sequence-sets">
<h3><a class="toc-backref" href="#id11">Construction of sequence sets</a><a class="headerlink" href="#construction-of-sequence-sets" title="Permalink to this headline">¶</a></h3>
<p>The first step is construction of alignment of H1 HA sequences. The ultimate set of aligned sequences are in <code class="docutils literal"><span class="pre">aligned_HAs.fasta</span></code>.</p>
<div class="section" id="parsing-and-alignment-of-sequences">
<h4>Parsing and alignment of sequences<a class="headerlink" href="#parsing-and-alignment-of-sequences" title="Permalink to this headline">¶</a></h4>
<p>The alignment is done by the <a class="reference external" href="http://www.python.org/">Python</a> script <code class="docutils literal"><span class="pre">parse_H1_HumanSwine.py</span></code> using the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">parse_H1_HumanSwine</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Briefly, the script functions as follows:</p>
<ol class="arabic">
<li><p class="first">All sequences in <code class="docutils literal"><span class="pre">H1_HAseqs.fasta</span></code> are read, and any sequences defined by anomalous (are listed in <code class="docutils literal"><span class="pre">JVI_82_8947_Anomalies.txt</span></code> or <code class="docutils literal"><span class="pre">JDB_Anomalies.txt</span></code>) are removed, as are sequences with ambiguous nucleotides, sequences that are not at least 1695 nucleotides in length, or sequences with headers that cannot be parsed.</p>
</li>
<li><p class="first">Of the remaining sequences, only the following are retained:</p>
<blockquote>
<div><ul class="simple">
<li>Human H1N1 from 1918 to 1957, and from 1977 to 2014.</li>
<li>Swine H1N1 from any year.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">For these retained sequences, a maximum of three sequences per host and year. The sequences that are retained are the three unique sequences that have the most occurrences in <code class="docutils literal"><span class="pre">H1_HAseqs.fasta</span></code> in that host / year &#8211; the idea here is to avoid picking sequences with outlier mutations. If there are multiple sequences with equal numbers of occurrences, one is chosen randomly.</p>
</li>
<li><p class="first">The sequences are pairwise aligned with <a class="reference external" href="http://emboss.sourceforge.net/download/">EMBOSS needle</a> to the WSN HA (<code class="docutils literal"><span class="pre">WSN-HA.fasta</span></code>), and any gaps relative to this reference sequence are removed. The retained sequences are written to <code class="docutils literal"><span class="pre">aligned_HAs.fasta</span></code>.</p>
</li>
</ol>
</div>
<div class="section" id="molecular-clock-analysis-for-anomalous-and-off-lineage-sequences">
<h4>Molecular clock analysis for anomalous and off-lineage sequences<a class="headerlink" href="#molecular-clock-analysis-for-anomalous-and-off-lineage-sequences" title="Permalink to this headline">¶</a></h4>
<p>To identify and remove any anomalous sequences in <code class="docutils literal"><span class="pre">aligned_HA.fasta</span></code>, an analysis is performed to make sure the sequences conform reasonably well to the molecular clock. Sequences that don&#8217;t conform could be misannotated, lab adapted, or (most frequently) are genuine H1N1 that are not from the major lineage (for example, European swine H1N1 or the 1976 Fort Dix swine flu in humans).</p>
<p>All sequences written by <code class="docutils literal"><span class="pre">parse_seqs.py</span></code> to <code class="docutils literal"><span class="pre">aligned_HAs.fasta</span></code> have their date pre-pended.
Human seasonal H1N1 reappeared in 1977 and persisted through 2008. The appearance was due to revival of the human H1N1 from about 1954. The dates for these sequences therefore need to have 24 years substracted in order to conform to a molecular clock (see <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/19787384">dos Reis et al, 2009</a>) &#8211; this is done by <code class="docutils literal"><span class="pre">parse_seqs.py</span></code></p>
<p>An analysis for concordance with the molecular clock is performed using <a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a> and <a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a>. Specifically:</p>
<ol class="arabic">
<li><p class="first">Build a <a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a> tree (no date stamping) to allow visual inspection for possible outliers, and write this tree to the <code class="docutils literal"><span class="pre">RAxML_output</span></code> subdirectory:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">raxmlHPC</span><span class="o">-</span><span class="n">SSE3</span> <span class="o">-</span><span class="n">w</span> <span class="o">./</span><span class="n">RAxML_output</span> <span class="o">-</span><span class="n">n</span> <span class="n">aligned_HAs</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1</span> <span class="o">-</span><span class="n">m</span> <span class="n">GTRCAT</span> <span class="o">-</span><span class="n">s</span> <span class="n">aligned_HAs</span><span class="o">.</span><span class="n">fasta</span>
</pre></div>
</div>
</li>
<li><p class="first">The tree was then visually inspected using <a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a> and <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>, and clear outliers from the molecular clock were removed by adding them to <code class="docutils literal"><span class="pre">JDB_Anomalies.txt</span></code> and re-running the analysis.</p>
</li>
<li><p class="first">This was repeated until there were no further outliers.</p>
</li>
<li><p class="first">In addition, sequences that appeared to be one-off zoonotic transfers (i.e. a single avian virus in an otherwise swine lineage, etc) were also added to <code class="docutils literal"><span class="pre">JDB_Anomalies.txt</span></code>.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="construction-of-phylogenetic-trees">
<h3><a class="toc-backref" href="#id12">Construction of phylogenetic trees</a><a class="headerlink" href="#construction-of-phylogenetic-trees" title="Permalink to this headline">¶</a></h3>
<p>High-quality phylogenetic trees of the sequences in <code class="docutils literal"><span class="pre">aligned_HAs.fasta</span></code> were constructed using <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a>.
The <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> script <code class="docutils literal"><span class="pre">phyloExpCM_runcodonPhyML.py</span></code> (see <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a> for details) was used to run <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a>.</p>
<p>Two trees were built with two different codon substitution models:</p>
<blockquote>
<div><ul>
<li><p class="first">The <em>GY94</em> codon model (<a class="reference external" href="http://mbe.oxfordjournals.org/content/11/5/725.full.pdf">Goldman and Yang 1994</a>) was used with the following setting:</p>
<blockquote>
<div><ul class="simple">
<li>The equilibrium codon frequencies estimated emprically using the <a class="reference external" href="http://www.plosone.org/article/info%3Adoi/10.1371/journal.pone.0011230">CF3x4</a> method.</li>
<li>A single transition / transversion ratio (<em>kappa</em>) estimated by maximum likelihood.</li>
<li>The dN/dS ratio (<em>omega</em>) drawn from four discrete gamma-distributed categories (<a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/7932792">Yang 1994</a>) with the shape parameter and mean estimated by maximum likelihood.</li>
</ul>
</div></blockquote>
<p>The tree construction was performed in the <code class="docutils literal"><span class="pre">./CodonPhyML_Tree_H1_HumanSwine_GY94/</span></code> subdirectory of the example subdirectory. The tree itself is in the file <code class="docutils literal"><span class="pre">./CodonPhyML_Tree_H1_HumanSwine_GY94/codonphyml_tree.newick</span></code>.</p>
</li>
<li><p class="first">The <em>KOSI07</em> codon model (<a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/17400572">Kosiol et al 2007</a>) was used with the following setting:</p>
<blockquote>
<div><ul class="simple">
<li>The equilibrium codon frequencies estimated emprically using the <em>F</em> method.</li>
<li>A single transition / transversion ratio (<em>kappa</em>) estimated by maximum likelihood.</li>
<li>The dN/dS ratio (<em>omega</em>) drawn from four discrete gamma-distributed categories (<a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/7932792">Yang 1994</a>) with the shape parameter and mean estimated by maximum likelihood.</li>
</ul>
</div></blockquote>
<p>The tree construction was performed in the <code class="docutils literal"><span class="pre">./CodonPhyML_Tree_H1_HumanSwine_KOSI07/</span></code> subdirectory of the example subdirectory. The tree itself is in the file <code class="docutils literal"><span class="pre">./CodonPhyML_Tree_H1_HumanSwine_KOSI07/codonphyml_tree.newick</span></code>.</p>
</li>
</ul>
</div></blockquote>
<p>To visualize the tree, the following <strong>manual</strong> steps were performed:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">The <code class="docutils literal"><span class="pre">codonphyml_tree.newick</span></code> tree in each of the two subdirectories was opened with <a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a>, the tree was re-rooted according to the dates assigned to the tips, and the re-rooted tree was saved with the name <code class="docutils literal"><span class="pre">rooted_tree.trees</span></code>.</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">rooted_tree.trees</span></code> file was opened in <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>, adjusted for attractive visual display, and saved to the file <code class="docutils literal"><span class="pre">annotated_tree.trees</span></code>.</p>
</li>
<li><p class="first">A PDF image of the tree in the <code class="docutils literal"><span class="pre">annotated_tree.trees</span></code> file was saved manually with <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>, and then converted to a JPG with <a class="reference external" href="http://www.imagemagick.org/script/convert.php">ImageMagick convert</a> using the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">convert</span> <span class="o">-</span><span class="n">density</span> <span class="mi">300</span> <span class="n">annotated_tree</span><span class="o">.</span><span class="n">pdf</span> <span class="n">annotated_tree</span><span class="o">.</span><span class="n">jpg</span>
</pre></div>
</div>
</li>
</ol>
</div></blockquote>
<p>The tree images created by these steps are shown below. Note that these trees are extremely similar regardless of the whether the <em>GY94</em> or <em>KOSI07</em> model is used to infer the topology.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/example_2014Analysis_Influenza_H1_HA_CodonPhyML_Tree_H1_HumanSwine_GY94_annotated_tree.jpg"><img alt="CodonPhyML_Tree_H1_HumanSwine_GY94/annotated_tree.jpg" src="_images/example_2014Analysis_Influenza_H1_HA_CodonPhyML_Tree_H1_HumanSwine_GY94_annotated_tree.jpg" style="width: 65%;" /></a>
<p class="caption"><span class="caption-text">Image of the tree generated by <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> for the <em>GY94</em> substitution model (file <code class="docutils literal"><span class="pre">./CodonPhyML_Tree_H1_HumanSwine_GY94/annotated_tree.jpg</span></code>). The swine HAs descended from the 1918 virus are shown in red. The human H1N1 from 1918 to 1957 directly descended from the 1918 virus are shown in blue. The human H1N1 that reappeared in 1977 is shown in purple. The 2009 swine-origin pandemic H1N1 is shown in green.</span></p>
</div>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/example_2014Analysis_Influenza_H1_HA_CodonPhyML_Tree_H1_HumanSwine_KOSI07_annotated_tree.jpg"><img alt="CodonPhyML_Tree_H1_HumanSwine_KOSI07/annotated_tree.jpg" src="_images/example_2014Analysis_Influenza_H1_HA_CodonPhyML_Tree_H1_HumanSwine_KOSI07_annotated_tree.jpg" style="width: 65%;" /></a>
<p class="caption"><span class="caption-text">Image of the tree generated by <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> for the <em>KOSI07</em> substitution model (file <code class="docutils literal"><span class="pre">./CodonPhyML_Tree_H1_HumanSwine_KOSI07/annotated_tree.jpg</span></code>). The swine HAs descended from the 1918 virus are shown in red. The human H1N1 from 1918 to 1957 directly descended from the 1918 virus are shown in blue. The human H1N1 that reappeared in 1977 is shown in purple. The 2009 swine-origin pandemic H1N1 is shown in green.</span></p>
</div>
</div>
<div class="section" id="computing-evolutionary-equilibrium-frequencies">
<h3><a class="toc-backref" href="#id13">Computing evolutionary equilibrium frequencies</a><a class="headerlink" href="#computing-evolutionary-equilibrium-frequencies" title="Permalink to this headline">¶</a></h3>
<p>The expected evolutionary frequencies are different than the site-specific amino-acid preferences due to the structure of the genetic code (for example, lysine has six more codons than methionine, and so will be six times as abundant if the preferences are equal) as well as the mutation rates when these are non-symmetric.</p>
<p>These expected evolutionary equilibrium frequencies are computed using the <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> script <code class="docutils literal"><span class="pre">phyloExpCM_builHyphyExpCM.py</span></code>, and are in the subdirectory <code class="docutils literal"><span class="pre">./evolutionary_frequencies/</span></code>.</p>
<p>Below is a logo plot showing these frequencies for sequential 1, 2, ... numbering of the WSN HA:</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/example_2014Analysis_Influenza_H1_HA_evolutionary_frequencies_sequential_numbering_combined_evolequilfreqs_site_preferences_logoplot.jpg"><img alt="evolutionary_frequencies/sequential_numbering_combined_evolequilfreqs_site_preferences_logoplot.jpg" src="_images/example_2014Analysis_Influenza_H1_HA_evolutionary_frequencies_sequential_numbering_combined_evolequilfreqs_site_preferences_logoplot.jpg" style="width: 65%;" /></a>
<p class="caption"><span class="caption-text">The expected evolutionary equilibrium frequencies using the site-specific amino-acid preferences from the combined replicates and sequential 1, 2, ... numbering of the WSN HA. This is the file <code class="docutils literal"><span class="pre">evolutionary_frequencies/sequential_numbering_combined_evolequilfreqs_site_preferences_logoplot.jpg</span></code>.</span></p>
</div>
</div>
<div class="section" id="correlations-between-preferences-and-evolutionary-conservation">
<h3><a class="toc-backref" href="#id14">Correlations between preferences and evolutionary conservation</a><a class="headerlink" href="#correlations-between-preferences-and-evolutionary-conservation" title="Permalink to this headline">¶</a></h3>
<p>A very crude analysis is to examine the correlation between the amino-acid preferences and the frequency with which residues are present in the natural sequences that compose the phylogenetic trees shown in <a class="reference internal" href="#construction-of-phylogenetic-trees">Construction of phylogenetic trees</a>. The reason why this is a crude analysis is that evolution on this timescale is not ergodic, so we wouldn&#8217;t expect residues to be sampled in the trees according to their preferences even if those preferences were exactly correct. So the better analysis is really that done in the next section (<a class="reference internal" href="#analysis-of-tree-with-various-substitution-models">Analysis of tree with various substitution models</a>) which takes into account phylogeny. Nonetheless, it is simple and easy to compare the preferences and frequencies in the natural sequence alignments. This analysis is done in the subdirectory <code class="docutils literal"><span class="pre">./frequency_correlations/</span></code>.</p>
<p>First, the <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> script <code class="docutils literal"><span class="pre">phyloExpCM_FreqsFromAlignment.py</span></code> is used to calculate the frequencies in the natural alignment (<code class="docutils literal"><span class="pre">H1_HumanSwine_alignment.fasta</span></code>): these frequencies are reported in <code class="docutils literal"><span class="pre">./frequency_correlations/H1_HumanSwine_alignment_frequencies.txt</span></code>.</p>
<p>Next, the <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> script <code class="docutils literal"><span class="pre">mapmuts_preferencescorrelate.py</span></code> is used to correlate these natural frequencies the amino-acid preferences. The results are plotted below. Although the correlation is far from perfect, it is substantial and highly significant.</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/example_2014Analysis_Influenza_H1_HA_frequency_correlations_natural_frequency_vs_preference.jpg"><img alt="frequency_correlations/natural_frequency_vs_preference.jpg" src="_images/example_2014Analysis_Influenza_H1_HA_frequency_correlations_natural_frequency_vs_preference.jpg" style="width: 35%;" /></a>
<p class="caption"><span class="caption-text">The site-specific amino-acid preferences (the average of the three replicates) are substantially correlated with the actual frequencies of different amino acids in the natural sequences. This is the plot <code class="docutils literal"><span class="pre">frequency_correlations/natural_frequency_vs_preference.jpg</span></code>.</span></p>
</div>
</div>
<div class="section" id="analysis-of-tree-with-various-substitution-models">
<h3><a class="toc-backref" href="#id15">Analysis of tree with various substitution models</a><a class="headerlink" href="#analysis-of-tree-with-various-substitution-models" title="Permalink to this headline">¶</a></h3>
<p>The tree topologies were analyzed with experimentally determined and &#8220;conventional&#8221; codon substitution models.</p>
<p>For each of these substitution models, the tree topology was fixed but the branch lengths and model parameters were optimized to give the maximum likelihood. These optimizations were done using <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> run by the <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> script <code class="docutils literal"><span class="pre">phyloExpCM_optimizeHyphyTree.py</span></code> (for conventional substitution models) or <code class="docutils literal"><span class="pre">phyloExpCM_ExpModelOptimizeHyphyTree.py</span></code> (for experimentally determined models).</p>
<p>The conventional models used were variants of the <em>GY94</em> codon model (<a class="reference external" href="http://mbe.oxfordjournals.org/content/11/5/725.full.pdf">Goldman and Yang 1994</a>) and <em>KOSI07</em> (<a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/17400572">Kosiol et al 2007</a>) modes. For <em>GY94</em>, the <a class="reference external" href="http://www.plosone.org/article/info%3Adoi/10.1371/journal.pone.0011230">CF3x4</a> method was used to determine the equilibrium codon frequencies (9 free parameters). For <em>KOSI07</em>, the <em>F</em> method was used to determine the equilibrium codon frequencies (60 free parameters). In all cases,  <em>kappa</em> (the transition-transversion ratio) was estimated as a single values by maximum likelihood. For some variants, the rate was drawn from a discrete gamma distribution (4 categories) with shape parameter estimated by maximum likelihood. The following approaches were taken to estimate <em>omega</em> (the nonsynonymous / synonymous ratio):</p>
<blockquote>
<div><ul class="simple">
<li>A single value estimated by maximum likelihood.</li>
<li>Four discrete gamma categories with mean and shape parameters estimated by maximum likelihood.</li>
<li>A different value for each branch estimated by maximum likelihood.</li>
</ul>
</div></blockquote>
<p>The experimentally determined substitution models used either the <em>HalpernBruno</em> or <em>FracTolerated</em> methods to compute the evolutionary models &#8211; these methods are described in the <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a>.</p>
<p>The results of the optimizations for the various substitution models are in the subdirectory <code class="docutils literal"><span class="pre">./codonmodel_optimized_trees/</span></code>. Within this subdirectory are further subdirectories containing the results of optimizing the branch lengths with <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> using the indicated codon substitution models. Files within these subdirectories give the results of the optimizations.</p>
<p>Overall summaries are in the following files:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">H1_HumanSwine_GY94_summary.csv</span></code> : optimizations of the tree topology estimated using <em>GY94</em>.</li>
<li><code class="docutils literal"><span class="pre">H1_HumanSwine_GY94_summary.tex</span></code> : like above, but in LaTex format.</li>
<li><code class="docutils literal"><span class="pre">H1_HumanSwine_KOSI07_summary.csv</span></code> : optimizations of the tree topology estimated using <em>KOSI07</em>.</li>
<li><code class="docutils literal"><span class="pre">H1_HumanSwine_KOSI07_summary.tex</span></code> : like above, but in LaTex format.</li>
</ul>
</div></blockquote>
<p>Here are the results for the <em>GY94</em> tree topology:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#Summary for tree H1_HumanSwine_GY94.</span>
<span class="c1">#</span>
<span class="c1">#SUBSTITUTION_MODEL, dAIC, LOG_LIKELIHOOD, FREE_PARAMETERS, MAXIMUM_LIKELIHOOD_PARAMETERS, EMPIRICAL_PARAMETERS</span>
<span class="n">combined</span><span class="o">-</span><span class="n">FracTolerated</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">24088.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_3</span><span class="o">-</span><span class="n">FracTolerated</span><span class="p">,</span> <span class="mf">303.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">24240.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">combined</span><span class="o">-</span><span class="n">HalpernBruno</span><span class="p">,</span> <span class="mf">500.6</span><span class="p">,</span> <span class="o">-</span><span class="mi">24339</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_1</span><span class="o">-</span><span class="n">FracTolerated</span><span class="p">,</span> <span class="mf">535.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">24356.4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_3</span><span class="o">-</span><span class="n">HalpernBruno</span><span class="p">,</span> <span class="mf">657.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">24417.6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_2</span><span class="o">-</span><span class="n">FracTolerated</span><span class="p">,</span> <span class="mf">876.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">24526.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">GY94_CF3x4_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">gamma4_rates</span><span class="o">-</span><span class="n">gamma4</span><span class="p">,</span> <span class="mf">882.573</span><span class="p">,</span> <span class="o">-</span><span class="mi">24517</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span>
<span class="n">replicate_1</span><span class="o">-</span><span class="n">HalpernBruno</span><span class="p">,</span> <span class="mf">983.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">24580.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">GY94_CF3x4_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">gamma4_rates</span><span class="o">-</span><span class="n">one</span><span class="p">,</span> <span class="mf">1109.67</span><span class="p">,</span> <span class="o">-</span><span class="mf">24631.5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span>
<span class="n">replicate_2</span><span class="o">-</span><span class="n">HalpernBruno</span><span class="p">,</span> <span class="mi">1190</span><span class="p">,</span> <span class="o">-</span><span class="mf">24683.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">KOSI07_F_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">gamma4_rates</span><span class="o">-</span><span class="n">gamma4</span><span class="p">,</span> <span class="mf">1620.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">24834.9</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">60</span>
<span class="n">GY94_CF3x4_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">one_rates</span><span class="o">-</span><span class="n">gamma4</span><span class="p">,</span> <span class="mf">1859.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">25006.4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span>
<span class="n">KOSI07_F_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">gamma4_rates</span><span class="o">-</span><span class="n">one</span><span class="p">,</span> <span class="mi">1883</span><span class="p">,</span> <span class="o">-</span><span class="mf">24967.2</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">60</span>
<span class="n">KOSI07_F_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">one_rates</span><span class="o">-</span><span class="n">gamma4</span><span class="p">,</span> <span class="mf">2378.83</span><span class="p">,</span> <span class="o">-</span><span class="mf">25215.1</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">60</span>
<span class="n">GY94_CF3x4_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">one_rates</span><span class="o">-</span><span class="n">one</span><span class="p">,</span> <span class="mf">2544.53</span><span class="p">,</span> <span class="o">-</span><span class="mi">25350</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span>
<span class="n">KOSI07_F_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">one_rates</span><span class="o">-</span><span class="n">one</span><span class="p">,</span> <span class="mf">3039.97</span><span class="p">,</span> <span class="o">-</span><span class="mf">25546.7</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">60</span>
<span class="n">combined</span><span class="o">-</span><span class="n">FracToleratedrandomized</span><span class="p">,</span> <span class="mf">5632.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">26905.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_1</span><span class="o">-</span><span class="n">FracToleratedrandomized</span><span class="p">,</span> <span class="mf">6002.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">27089.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_3</span><span class="o">-</span><span class="n">FracToleratedrandomized</span><span class="p">,</span> <span class="mf">6138.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">27158.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_2</span><span class="o">-</span><span class="n">FracToleratedrandomized</span><span class="p">,</span> <span class="mf">6477.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">27327.6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">combined</span><span class="o">-</span><span class="n">HalpernBrunorandomized</span><span class="p">,</span> <span class="mf">7072.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">27625.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_1</span><span class="o">-</span><span class="n">HalpernBrunorandomized</span><span class="p">,</span> <span class="mi">7795</span><span class="p">,</span> <span class="o">-</span><span class="mf">27986.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_3</span><span class="o">-</span><span class="n">HalpernBrunorandomized</span><span class="p">,</span> <span class="mf">7891.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">28034.6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_2</span><span class="o">-</span><span class="n">HalpernBrunorandomized</span><span class="p">,</span> <span class="mf">8494.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">28335.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Here are the results for the <em>KOSI07</em> tree topology:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#Summary for tree H1_HumanSwine_KOSI07.</span>
<span class="c1">#</span>
<span class="c1">#SUBSTITUTION_MODEL, dAIC, LOG_LIKELIHOOD, FREE_PARAMETERS, MAXIMUM_LIKELIHOOD_PARAMETERS, EMPIRICAL_PARAMETERS</span>
<span class="n">combined</span><span class="o">-</span><span class="n">FracTolerated</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">24082.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_3</span><span class="o">-</span><span class="n">FracTolerated</span><span class="p">,</span> <span class="mf">304.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">24234.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">combined</span><span class="o">-</span><span class="n">HalpernBruno</span><span class="p">,</span> <span class="mf">494.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">24329.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_1</span><span class="o">-</span><span class="n">FracTolerated</span><span class="p">,</span> <span class="mf">534.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">24349.6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_3</span><span class="o">-</span><span class="n">HalpernBruno</span><span class="p">,</span> <span class="mf">653.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">24409.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_2</span><span class="o">-</span><span class="n">FracTolerated</span><span class="p">,</span> <span class="mf">869.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">24517.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">GY94_CF3x4_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">gamma4_rates</span><span class="o">-</span><span class="n">gamma4</span><span class="p">,</span> <span class="mf">876.673</span><span class="p">,</span> <span class="o">-</span><span class="mf">24507.8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span>
<span class="n">replicate_1</span><span class="o">-</span><span class="n">HalpernBruno</span><span class="p">,</span> <span class="mf">976.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">24570.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">GY94_CF3x4_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">gamma4_rates</span><span class="o">-</span><span class="n">one</span><span class="p">,</span> <span class="mf">1100.99</span><span class="p">,</span> <span class="o">-</span><span class="mi">24621</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span>
<span class="n">replicate_2</span><span class="o">-</span><span class="n">HalpernBruno</span><span class="p">,</span> <span class="mf">1180.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">24672.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">KOSI07_F_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">gamma4_rates</span><span class="o">-</span><span class="n">gamma4</span><span class="p">,</span> <span class="mf">1609.02</span><span class="p">,</span> <span class="o">-</span><span class="mi">24823</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">60</span>
<span class="n">GY94_CF3x4_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">one_rates</span><span class="o">-</span><span class="n">gamma4</span><span class="p">,</span> <span class="mf">1856.23</span><span class="p">,</span> <span class="o">-</span><span class="mf">24998.6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span>
<span class="n">KOSI07_F_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">gamma4_rates</span><span class="o">-</span><span class="n">one</span><span class="p">,</span> <span class="mf">1867.29</span><span class="p">,</span> <span class="o">-</span><span class="mf">24953.1</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">60</span>
<span class="n">KOSI07_F_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">one_rates</span><span class="o">-</span><span class="n">gamma4</span><span class="p">,</span> <span class="mf">2367.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">25203.4</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">60</span>
<span class="n">GY94_CF3x4_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">one_rates</span><span class="o">-</span><span class="n">one</span><span class="p">,</span> <span class="mf">2548.27</span><span class="p">,</span> <span class="o">-</span><span class="mf">25345.6</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span>
<span class="n">KOSI07_F_omega</span><span class="o">-</span><span class="k">global</span><span class="o">-</span><span class="n">one_rates</span><span class="o">-</span><span class="n">one</span><span class="p">,</span> <span class="mf">3027.99</span><span class="p">,</span> <span class="o">-</span><span class="mf">25534.5</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">60</span>
<span class="n">combined</span><span class="o">-</span><span class="n">FracToleratedrandomized</span><span class="p">,</span> <span class="mi">5628</span><span class="p">,</span> <span class="o">-</span><span class="mf">26896.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_1</span><span class="o">-</span><span class="n">FracToleratedrandomized</span><span class="p">,</span> <span class="mf">5993.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">27079.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_3</span><span class="o">-</span><span class="n">FracToleratedrandomized</span><span class="p">,</span> <span class="mi">6138</span><span class="p">,</span> <span class="o">-</span><span class="mf">27151.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_2</span><span class="o">-</span><span class="n">FracToleratedrandomized</span><span class="p">,</span> <span class="mf">6475.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">27320.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">combined</span><span class="o">-</span><span class="n">HalpernBrunorandomized</span><span class="p">,</span> <span class="mf">7069.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">27617.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_1</span><span class="o">-</span><span class="n">HalpernBrunorandomized</span><span class="p">,</span> <span class="mf">7786.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">27975.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_3</span><span class="o">-</span><span class="n">HalpernBrunorandomized</span><span class="p">,</span> <span class="mf">7889.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">28027.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">replicate_2</span><span class="o">-</span><span class="n">HalpernBrunorandomized</span><span class="p">,</span> <span class="mi">8496</span><span class="p">,</span> <span class="o">-</span><span class="mf">28330.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</pre></div>
</div>
<p>The models are ranked in order of <a class="reference external" href="http://en.wikipedia.org/wiki/Akaike_information_criterion">AIC</a> difference from the best model. Both tree topologies give nearly identical results. These results show that:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The experimentally determined evolutionary models using the estimates from the three replicates combined (these are expected to be the best estimates) are clearly far superior to any of the conventional substitution models. This repeats the finding in <a class="reference external" href="http://biorxiv.org/content/early/2014/03/05/002899">Bloom 2014</a> that experimentally determined evolutionary models are superior.</li>
<li>The models from the individual replicates are also generally better than the conventional models, but not by as large a margin. Presumably this is because estimating the evolutionary model from just one replicate is not as accurate.</li>
<li>The <em>FracTolerated</em> model is superior to the <em>HalpernBruno</em> model (this was also found to be the case in <a class="reference external" href="http://biorxiv.org/content/early/2014/03/05/002899">Bloom 2014</a>).</li>
<li>Randomizing the preferences among sites makes the models far worse than conventional models.</li>
</ol>
</div></blockquote>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2014 analysis of H1 influenza HAs descended from 1918 virus</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#software-used">Software used</a></li>
<li><a class="reference internal" href="#input-files">Input files</a></li>
<li><a class="reference internal" href="#running-the-analysis">Running the analysis</a></li>
<li><a class="reference internal" href="#steps-in-the-analysis">Steps in the analysis</a><ul>
<li><a class="reference internal" href="#construction-of-sequence-sets">Construction of sequence sets</a><ul>
<li><a class="reference internal" href="#parsing-and-alignment-of-sequences">Parsing and alignment of sequences</a></li>
<li><a class="reference internal" href="#molecular-clock-analysis-for-anomalous-and-off-lineage-sequences">Molecular clock analysis for anomalous and off-lineage sequences</a></li>
</ul>
</li>
<li><a class="reference internal" href="#construction-of-phylogenetic-trees">Construction of phylogenetic trees</a></li>
<li><a class="reference internal" href="#computing-evolutionary-equilibrium-frequencies">Computing evolutionary equilibrium frequencies</a></li>
<li><a class="reference internal" href="#correlations-between-preferences-and-evolutionary-conservation">Correlations between preferences and evolutionary conservation</a></li>
<li><a class="reference internal" href="#analysis-of-tree-with-various-substitution-models">Analysis of tree with various substitution models</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="example_2014Analysis_Influenza_NP_Human_1918_Descended_withbeta.html"
                        title="previous chapter">2014 analysis of influenza NP with stringency parameter</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="modules.html"
                        title="next chapter">Python modules in phyloExpCM</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/example_2014Analysis_Influenza_H1_HA.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Python modules in phyloExpCM"
             >next</a> |</li>
        <li class="right" >
          <a href="example_2014Analysis_Influenza_NP_Human_1918_Descended_withbeta.html" title="2014 analysis of influenza NP with stringency parameter"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phyloExpCM 0.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" >Examples</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Jesse D. Bloom.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.
    </div>
  </body>
</html>