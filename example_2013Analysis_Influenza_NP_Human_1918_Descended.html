<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2013 analysis of human influenza NPs descended from 1918 virus &mdash; phyloExpCM 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="phyloExpCM 0.2 documentation" href="index.html" />
    <link rel="up" title="Examples" href="examples.html" />
    <link rel="next" title="2014 analysis of beta-lactamase phylogenetic fit" href="example_2014Analysis_lactamase.html" />
    <link rel="prev" title="Examples" href="examples.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="example_2014Analysis_lactamase.html" title="2014 analysis of beta-lactamase phylogenetic fit"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">phyloExpCM 0.2 documentation</a> &raquo;</li>
          <li><a href="examples.html" accesskey="U">Examples</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="analysis-of-human-influenza-nps-descended-from-1918-virus">
<h1><a class="toc-backref" href="#id1">2013 analysis of human influenza NPs descended from 1918 virus</a><a class="headerlink" href="#analysis-of-human-influenza-nps-descended-from-1918-virus" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#analysis-of-human-influenza-nps-descended-from-1918-virus" id="id1">2013 analysis of human influenza NPs descended from 1918 virus</a><ul>
<li><a class="reference internal" href="#overview" id="id2">Overview</a></li>
<li><a class="reference internal" href="#software-used" id="id3">Software used</a></li>
<li><a class="reference internal" href="#input-files" id="id4">Input files</a></li>
<li><a class="reference internal" href="#running-the-analysis" id="id5">Running the analysis</a></li>
<li><a class="reference internal" href="#steps-in-the-analysis" id="id6">Steps in the analysis</a><ul>
<li><a class="reference internal" href="#creation-of-sequence-alignments" id="id7">Creation of sequence alignments</a></li>
<li><a class="reference internal" href="#check-for-outlier-sequences" id="id8">Check for outlier sequences</a></li>
<li><a class="reference internal" href="#construction-of-phylogenetic-trees" id="id9">Construction of phylogenetic trees</a></li>
<li><a class="reference internal" href="#construction-of-experimental-substitution-models" id="id10">Construction of experimental substitution models</a></li>
<li><a class="reference internal" href="#optimizing-the-trees-with-various-substitution-models" id="id11">Optimizing the trees with various substitution models</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id2">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This is a description of an analysis of the effectiveness of experimentally determined substitution models for describing the evolution of influenza nucleoprotein (NP).</p>
<p>This analysis was performed by <a class="reference external" href="http://research.fhcrc.org/bloom/en.html">Jesse Bloom</a>.</p>
<p>The overall approach is to use the <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> package to analyze a NP phylogeny using an experimentally derived substitution model from a <a class="reference external" href="http://jbloom.github.io/mapmuts/example_2013Analysis_Influenza_NP_Aichi68.html">mapmuts analysis of the Aichi68 influenza NP from 2013</a>, and to compare this model to various standard codon substitution models.</p>
<p>Much of the analysis itself is performed using <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a>, which is run by <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> using the scripts detailed in the <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a>.</p>
<p>The phylogenetic tree that is analyzed consists of human influenza lineages with their NPs directly descended from the 1918 virus, specifically:</p>
<blockquote>
<div><ul class="simple">
<li>H1N1 from 1918 to 1957, and again from 1977 to 2008 (seasonal H1N1).</li>
<li>H2N2 from 1957 to 1968.</li>
<li>H3N2 from 1968 to 2013.</li>
</ul>
</div></blockquote>
<p>The code, data, and results from the analysis are in the <tt class="docutils literal"><span class="pre">./examples/2013Analysis_Influenza_NP_Human_1918_Descended/</span></tt> subdirectory in the main <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> package directory. This subdirectory contains all of the necessary input files (see <a class="reference internal" href="#input-files">Input files</a>) for running the analysis. It also contains a master script (<tt class="docutils literal"><span class="pre">run_analysis.py</span></tt>) that can be used to regenerate the analysis with the command:</p>
<div class="highlight-python"><div class="highlight"><pre>python run_analysis.py
</pre></div>
</div>
<p>provided that you have installed the software described in <a class="reference internal" href="#software-used">Software used</a>.</p>
</div>
<div class="section" id="software-used">
<h2><a class="toc-backref" href="#id3">Software used</a><a class="headerlink" href="#software-used" title="Permalink to this headline">¶</a></h2>
<p>The analysis was performed using the following software on the Fred Hutchinson computer cluster using the following Linux distribution:</p>
<div class="highlight-python"><div class="highlight"><pre>Linux version 3.5.0-43-generic (buildd@roseapple) (gcc version 4.6.3 (Ubuntu/Linaro 4.6.3-1ubuntu5) ) #66~precise1-Ubuntu SMP Thu Oct 24 14:52:23 UTC 2013
</pre></div>
</div>
<p>In order to replicate the analysis, you will need to use Linux or Mac OS X, and install the software listed below.</p>
<p>The specific versions of software used are specified. Other versions will likely work as well, but this has not been confirmed.</p>
<ul>
<li><p class="first"><a class="reference external" href="http://www.python.org/">Python</a> (version 2.7.3)</p>
</li>
<li><p class="first"><a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> (version 0.21).</p>
</li>
<li><p class="first"><a class="reference external" href="http://www.numpy.org/">numpy</a> (version 1.6.1)</p>
</li>
<li><p class="first"><a class="reference external" href="http://matplotlib.org/">matplotlib</a> (version 1.3.1).</p>
</li>
<li><p class="first"><a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> (version 1.0)</p>
</li>
<li><p class="first"><a class="reference external" href="http://emboss.sourceforge.net/download/">EMBOSS needle</a> (version 6.6.0). The executable with the name <tt class="docutils literal"><span class="pre">needle</span></tt> is expected to be in the current search path.</p>
</li>
<li><p class="first"><a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a> (version 7.7.6). The executable with the name <tt class="docutils literal"><span class="pre">raxmlHPC-SSE3</span></tt> is expected to be in the current search path. This is the SSE3 version, and was built using the command:</p>
<div class="highlight-python"><div class="highlight"><pre>make -f Makefile.SSE3.gcc
</pre></div>
</div>
<p>and then copying the executable into the search path.</p>
</li>
<li><p class="first"><a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a> (version 1.4) was used for the visual identification of outliers from the molecular clock and to root trees based on date-stamping.</p>
</li>
<li><p class="first"><a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a> (version 1.4.0) was used to open tree files for annotation, visualization, and saving of images.</p>
</li>
<li><p class="first"><a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> (version 1.00 201306.18) was used to build phylogenetic trees. The executable with the name <tt class="docutils literal"><span class="pre">codonphyml</span></tt> is expected to be in the current search path. This executable was compiled with the <em>omp</em> options to make it multi-threaded.</p>
</li>
<li><p class="first"><a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> (version HYPHY 2.220131214beta(MP) for Linux on x86_64) was used to optimize the branches and compute the likelihoods under the different models. The multiprocessor (<tt class="docutils literal"><span class="pre">HYPHYMP</span></tt>) version of the executable was used. To install this, the following commands were run in the unzipped <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> source code directory after download:</p>
<div class="highlight-python"><div class="highlight"><pre>cmake -DINSTALL_PREFIX=/home/jbloom/.local/ .
make MP2
make install
</pre></div>
</div>
</li>
<li><p class="first">This analysis was run on the FHCRC scientific computing cluster using <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> (version 2.6.2), and requires <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> to be installed to run as currently implemented. If you don&#8217;t want to use <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a>, all you need to do is modify the main <tt class="docutils literal"><span class="pre">run_analysis.py</span></tt> script to not submit any jobs via <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a>. The use of <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> in the current version simply allows more processors to be used simultaneously and so speeds up the analysis.</p>
</li>
<li><p class="first"><a class="reference external" href="http://www.imagemagick.org/script/convert.php">ImageMagick convert</a> 6.6.9-7 2012-08-17 was used to convert PDF files to JPGs.</p>
</li>
</ul>
</div>
<div class="section" id="input-files">
<h2><a class="toc-backref" href="#id4">Input files</a><a class="headerlink" href="#input-files" title="Permalink to this headline">¶</a></h2>
<p>Here are the input files that are necessary to repeat the analysis. These are the names assigned with the <tt class="docutils literal"><span class="pre">./examples/2013Analysis_Influenza_NP_Human_1918_Descended/</span></tt> subdirectory of the main <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> package.</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">run_analysis.py</span></tt> is a <a class="reference external" href="http://www.python.org/">Python</a> script that will perform the analysis assuming that you have all of the appropriate software (see <a class="reference internal" href="#software-used">Software used</a>) and input files. To run this script, use:</p>
<div class="highlight-python"><div class="highlight"><pre>python run_analysis.py
</pre></div>
</div>
<p>at the command line.</p>
</li>
<li><p class="first"><em>NPseqs.fasta</em> is the set of all unique full-length influenza A coding DNA sequences as downloaded from the <a class="reference external" href="http://www.ncbi.nlm.nih.gov/genomes/FLU/FLU.html">Influenza Virus Resource</a> on June-25-2013.</p>
</li>
<li><p class="first"><em>Aichi68-NP.fasta</em> is the coding DNA sequence for A/Aichi/2/1968 (H3N2) NP as taken from reverse-genetics plasmid pHWAichi68-NP.</p>
</li>
<li><p class="first"><em>JVI_82_8947_Anomalies.txt</em> is a list of the strain names for the sequences identified as anomalous (either frozen in time or recombinant) in Appendices 1 and 2 of <cite>Krasnitz et al, 2008</cite>.</p>
</li>
<li><p class="first"><em>JDB_Anomalies.txt</em> is a list of strain names that appear to be anomalous based on their strong violation of the molecular clock. These sequences are probably mis-annotated in the database, come from non-standard lineages (for examples a swine H3N2 isolated from humans), are reassortants (example would be an H1N1 NP that reassorted into an H3N2), or are extensively lab adapted and so deviate from the molecular clock due to large numbers ofadaptation mutations.</p>
</li>
<li><p class="first"><em>mutspectrum.txt</em> is a file that contains the experimentally measured nucleotide mutation rates.</p>
</li>
<li><p class="first">Files giving the inferred equilibrium amino-acid preferences at each site in NP. These files are from the <a class="reference external" href="http://jbloom.github.io/mapmuts/example_2013Analysis_Influenza_NP_Aichi68.html">mapmuts analysis of the Aichi68 influenza NP from 2013</a>. These files are in the format of the <tt class="docutils literal"><span class="pre">*_equilibriumpreferences.txt</span></tt> files created by <tt class="docutils literal"><span class="pre">mapmuts_inferpreferences.py</span></tt> as described in the <a class="reference external" href="http://jbloom.github.io/mapmuts/">mapmuts documentation</a>. There are three such files included here:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">replicate_A_p1_equilibriumpreferences.txt</span></tt> gives the preferences inferred from passage 1 (<em>p1</em>) from <em>replicate A</em>.</li>
<li><tt class="docutils literal"><span class="pre">replicate_B_p1_equilibriumpreferences.txt</span></tt> gives the preferences inferred from passage 1 (<em>p1</em>) from <em>replicate B</em>.</li>
<li><tt class="docutils literal"><span class="pre">p1_equilibriumpreferences.txt</span></tt> gives the average of the preferences from the two replicates above (<em>replicate A</em> and <em>replicate B</em>, both <em>p1</em>).</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">./DSSP_analysis/</span></tt> is a subdirectory that contains the results of analyzing the solvent accessibilities and secondary structures of NP from the crystal structure. Briefly, the NP crystal structure in <a class="reference external" href="http://www.rcsb.org/pdb/explore.do?structureId=2iqh">PDB 2IQH</a> was downloaded, and the <tt class="docutils literal"><span class="pre">2IQH.pdb</span></tt> file was manually edited to extract only monomer C into <tt class="docutils literal"><span class="pre">2IQH_monomerC.pdb</span></tt>. This monomer was then analyzed with the <a class="reference external" href="http://www.cmbi.ru.nl/hsspsoap/">DSSP webserver</a> to create the results stored in <tt class="docutils literal"><span class="pre">2IQH_monomerC.dssp</span></tt>.</p>
</li>
</ul>
</div>
<div class="section" id="running-the-analysis">
<h2><a class="toc-backref" href="#id5">Running the analysis</a><a class="headerlink" href="#running-the-analysis" title="Permalink to this headline">¶</a></h2>
<p>The analysis in this directory can be repeated simply by running the master script <tt class="docutils literal"><span class="pre">run_analysis.py</span></tt> from the command line with:</p>
<div class="highlight-python"><div class="highlight"><pre>python run_analysis.py
</pre></div>
</div>
<p>or running it using <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> with:</p>
<div class="highlight-python"><div class="highlight"><pre>sbatch run_analysis.sbatch
</pre></div>
</div>
<p>Other than the files delineated under <a class="reference internal" href="#input-files">Input files</a>, all data files in this directory can be re-generated with this command. However, the analysis approach does involve a few manual steps with <a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a> and <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a> to create nicely formatted and annotated tree images from the raw tree files produced by the script. These manual steps are indicated below.</p>
<p>There is a variable called <em>use_existing_output</em> that is hardcoded into the beginning of this script. This variable is currently set to <em>True</em>, which means that if output already exists it is <strong>not</strong> overwritten and regenerated. If you want to regenerate the output (such as after changing input files or altering analysis parameters), then either manually delete the old output or change <em>use_existing_output</em> to <em>False</em> to force the script to overwrite old output. This script does <strong>not</strong> automatically test for dependencies among files, so if you change a file but keep <em>use_existing_output</em> to <em>True</em>, then you need to manually remove any old files with dependencies.</p>
<p>Note that <tt class="docutils literal"><span class="pre">run_analysis.py</span></tt> uses multiple CPUs to speed up some of the analyses. If you don&#8217;t have as many CPUs on your system, you might want to check that you are not overloading the system &#8211; you can avoid this by using fewer CPUs, which will require you to manually modify the <tt class="docutils literal"><span class="pre">run_analysis.py</span></tt> script.</p>
<p>Note that <tt class="docutils literal"><span class="pre">run_analysis.py</span></tt> uses <a class="reference external" href="https://computing.llnl.gov/linux/slurm/sbatch.html">sbatch</a> by default to run some of its subsidiary programs &#8211; if you don&#8217;t want to do this, set the <em>use_sbatch</em> option to <em>False</em> within the program.</p>
</div>
<div class="section" id="steps-in-the-analysis">
<h2><a class="toc-backref" href="#id6">Steps in the analysis</a><a class="headerlink" href="#steps-in-the-analysis" title="Permalink to this headline">¶</a></h2>
<p>Here are the steps in the analysis. The command for each step is shown, but these commands (with the exception of some manual formatting of tree images with <a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a> and <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>) are run automatically by the main <tt class="docutils literal"><span class="pre">run_analysis.py</span></tt> script if you are using that.</p>
<div class="section" id="creation-of-sequence-alignments">
<h3><a class="toc-backref" href="#id7">Creation of sequence alignments</a><a class="headerlink" href="#creation-of-sequence-alignments" title="Permalink to this headline">¶</a></h3>
<p>Extract and align the human NP sequences descended from the 1918 virus into <em>Aligned_NPs.fasta</em>. This is done by the script <tt class="docutils literal"><span class="pre">get_treeseqs.py</span></tt>, by running:</p>
<div class="highlight-python"><div class="highlight"><pre>python get_treeseqs.py
</pre></div>
</div>
<p>The created <em>Aligned_NPs.fasta</em> includes the sequences with headers that give their isolation date (except for H1N1 from after 1977, where 24 years are subtracted from the isolation date for the reasons described below).</p>
<p>The specific steps are as follows:</p>
<ol class="arabic">
<li><p class="first">Read all sequences from <em>NPseqs.fasta</em>.</p>
</li>
<li><p class="first">Purge any sequences specified as anomalous in <em>JVI_82_8947_Anomalies.txt</em> and <em>JDB_Anomalies.txt</em>.</p>
</li>
<li><p class="first">Purge any sequences with ambiguous nucleotide identities.</p>
</li>
<li><p class="first">If there are redundant identical sequences, keep only one sequence from each set of identical sequences.</p>
</li>
<li><p class="first">Purge any sequences for which the host, year of isolation, or subtype is unavailable.</p>
</li>
<li><p class="first">Purge any sequences for which the host is something other than human.</p>
</li>
<li><p class="first">Keep at most 3 sequences per year from each of the following classifications. Sequences from other classifications are all removed. The classifications for which 3 per year are retained are:</p>
<blockquote>
<div><ul class="simple">
<li>H1N1 from 1918 to 1957: this is H1N1 directly descended from the 1918 virus.</li>
<li>H2N2 from 1957 to 1968: this H2N2 derived from reassortment of an avian virus with the existing H1N1 in the 1957 &#8220;Asian flu&#8221; pandemic. The NP in the new H2N2 was from the existing H1N1, which then went extinct.</li>
<li>H3N2 from 1968 to 2013: this is H3N2 derived from reassortment of an avian virus with thte existing H2N2 in the 1968 &#8220;Hong Kong flu&#8221; pandemic. The NP in the new H3N2 was from the existing H2N2, when then went extinct.</li>
<li>H1N1 from 1977 to 2008: this is &#8220;seasonal H1N1&#8221; that arose in 1977 in the &#8220;Russian flu&#8221; pandemic. This is a virus from the earlier human H1N1 that was frozen and re-released. The virus was frozen for about 24 years before this pandemic (estimate from <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/19787384">dos Reis et al, 2009</a>), and therefore <strong>24 years are subtracted from the isolation date of viruses in this lineage</strong>. This date subtraction is not important for the construction of the phylogenetic tree, but it is important for the <a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a> based analysis that assumes a molecular clock (see <a class="reference internal" href="#check-for-outlier-sequences">Check for outlier sequences</a>).</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Translate and align all of the protein sequences, then also construct nucleotide alignments from the protein alignments. The alignments are built with <a class="reference external" href="http://emboss.sourceforge.net/download/">EMBOSS needle</a>. The alignments are written to <em>Aligned_NPs.fasta</em> and <em>Aligned_NP_proteins.fasta</em>.</p>
</li>
</ol>
</div>
<div class="section" id="check-for-outlier-sequences">
<h3><a class="toc-backref" href="#id8">Check for outlier sequences</a><a class="headerlink" href="#check-for-outlier-sequences" title="Permalink to this headline">¶</a></h3>
<p>There are almost always clear &#8220;outlier&#8221; sequences in influenza phylogenies. These outliers can arise from several sources:</p>
<blockquote>
<div><ul class="simple">
<li>Mis-annotation of the date or subtype in the database.</li>
<li>Amplification of a lab contaminant during sequencing.</li>
<li>Sequencing of a zoonotic rather than epidemic strain. For example, there are currently low rates of swine-origin vH3N2 in humans. These strains are also sequenced and labeld as human H3N2 (since they are H3N2 from humans) &#8211; but they are not from the same evolutionary lineage, as they have been evolving in swine.</li>
</ul>
</div></blockquote>
<p>To eliminate such outliers, several steps were taken. First, sequences that have already been identified as anomalous <a class="reference external" href="http://jvi.asm.org/content/82/17/8947.abstract">Krasnitz et al, 2008</a> are eliminated in <a class="reference internal" href="#creation-of-sequence-alignments">Creation of sequence alignments</a> described above.</p>
<p>However, to identify further outliers, the following steps were taken. Essentially, these steps utilize <a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a> and <a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a> to manually identify sequences that are clear outliers from the molecular clock. These sequences are then added to the file <em>JDB_Anomalies</em>, and the steps in <a class="reference internal" href="#creation-of-sequence-alignments">Creation of sequence alignments</a> and then those here are repeated. This iterative process has been completed for the sequences here until no more outliers were identified.</p>
<p>Specifically, the steps were:</p>
<ol class="arabic">
<li><p class="first">The <tt class="docutils literal"><span class="pre">run_analysis.py</span></tt> script builds a <a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a> tree for quick visual inspection. <a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a> is used because it is a rapid method to build a reasonable maximum-likelihood tree. The steps:</p>
<blockquote>
<div><ol class="loweralpha">
<li><p class="first">The subdirectory <tt class="docutils literal"><span class="pre">./RAxML_output/</span></tt> was created</p>
</li>
<li><p class="first"><a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a> was run using the following command:</p>
<div class="highlight-python"><div class="highlight"><pre>raxmlHPC-SSE3 -w ./RAxML_output -n Aligned_NPs -p 1 -m GTRCAT -s Aligned_NPs.fasta
</pre></div>
</div>
<p>Note that for the actual command, the full path needs to be specified for the <tt class="docutils literal"><span class="pre">RAxML_output</span></tt> subdirectory as <a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a> does not handle relative paths &#8211; this is handled by the master script <tt class="docutils literal"><span class="pre">run_analysis.py</span></tt>.</p>
</li>
<li><p class="first">The following command will have created the best <a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a> tree as <tt class="docutils literal"><span class="pre">./RAxML_output/RAxML_bestTree.Aligned_NPs</span></tt>.</p>
</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">The next step is manual. Open this tree using <a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a>, and look manually to see if there are outliers from the molecular clock in the <tt class="docutils literal"><span class="pre">./RAxML_output/RAxML_bestTree.Aligned_NPs</span></tt> file. If so, add these outliers to <em>JDB_Anomalies.txt</em> and repeat the <a class="reference internal" href="#creation-of-sequence-alignments">Creation of sequence alignments</a> and this <a class="reference external" href="https://github.com/stamatak/standard-RAxML">RAxML</a> analysis. Note that this has already been done, so if you are just re-running the analysis then you don&#8217;t need to do this unless you have changed the sequence set.</p>
</li>
</ol>
</div>
<div class="section" id="construction-of-phylogenetic-trees">
<h3><a class="toc-backref" href="#id9">Construction of phylogenetic trees</a><a class="headerlink" href="#construction-of-phylogenetic-trees" title="Permalink to this headline">¶</a></h3>
<p>High-quality phylogenetic trees were then constructed using <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a>, which is able to build maximum-likelihood trees with codon substitution models.</p>
<p>The <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> script <tt class="docutils literal"><span class="pre">phyloExpCM_runcodonPhyML.py</span></tt> (see <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a> for details) was used to run <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a>. Trees were built using two different substitution models, with each tree in its own subdirectory within <tt class="docutils literal"><span class="pre">./examples/2013Analysis_Influenza_NP_Human_1918_Descended/</span></tt>. The substitution models used to build the trees:</p>
<blockquote>
<div><ul>
<li><p class="first">The <em>GY94</em> codon model (<a class="reference external" href="http://mbe.oxfordjournals.org/content/11/5/725.full.pdf">Goldman and Yang 1994</a>) with:</p>
<blockquote>
<div><ul class="simple">
<li>The equilibrium codon frequencies estimated emprically using the <a class="reference external" href="http://www.plosone.org/article/info%3Adoi/10.1371/journal.pone.0011230">CF3x4</a> method.</li>
<li>A single transition / transversion ratio (<em>kappa</em>) estimated by maximum likelihood.</li>
<li>The dN/dS ratio (<em>omega</em>) drawn from four discrete gamma-distributed categories (<a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/7932792">Yang 1994</a>) with the shape parameter and mean estimated by maximum likelihood.</li>
</ul>
</div></blockquote>
<p>The tree construction was performed in the <tt class="docutils literal"><span class="pre">./GY94_codonPhyML_tree/</span></tt> subdirectory. The tree itself is in the file <tt class="docutils literal"><span class="pre">./GY94_codonPhyML_tree/codonphyml_tree.newick</span></tt>.</p>
</li>
<li><p class="first">The <em>KOSI07</em> empirical codon model (<a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/17400572">Kosiol et al, 2007</a>), using the variant denoted as <em>ECM+F+omega+1kappa(tv)</em> in <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/17400572">Kosiol et al, 2007</a>. Specifically:</p>
<blockquote>
<div><ul class="simple">
<li>The equilibrium codon frequencies were estimated empirically using the <em>F</em> method (empirical estimation of 60 frequencies for the 61 non-stop codons).</li>
<li>The relative decrease in transversions versus transitions, <em>kappa(tv)</em>, estimated by maximum likelihood.</li>
<li>The relative elevation in nonsynonymous over synonymous mutations (<em>omega</em>) drawn from four gamma-distributed categories with shape parameter and mean estimated by maximum likelihood.</li>
</ul>
</div></blockquote>
<p>The tree construction was performed in the <tt class="docutils literal"><span class="pre">./KOSI07_codonPhyML_tree/</span></tt> subdirectory. The tree itself is in the file <tt class="docutils literal"><span class="pre">./KOSI07_codonPhyML_tree/codonphyml_tree.newick</span></tt>.</p>
</li>
</ul>
</div></blockquote>
<p>To visualize these trees, the following <strong>manual</strong> steps were performed:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">The <tt class="docutils literal"><span class="pre">codonphyml_tree.newick</span></tt> tree in each of the two subdirectories was opened with <a class="reference external" href="http://tree.bio.ed.ac.uk/software/pathogen/">Path-O-Gen</a>, the tree was re-rooted according to the dates assigned to the tips, and the re-rooted tree was saved with the name <tt class="docutils literal"><span class="pre">rooted_tree.trees</span></tt>.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">rooted_tree.trees</span></tt> file was opened in <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>, adjusted for attractive visual display, and saved to the file <tt class="docutils literal"><span class="pre">annotated_tree.trees</span></tt>.</p>
</li>
<li><p class="first">A PDF image of the tree in the <tt class="docutils literal"><span class="pre">annotated_tree.trees</span></tt> file was saved manually with <a class="reference external" href="http://tree.bio.ed.ac.uk/software/figtree/">FigTree</a>, and then converted to a JPG with <a class="reference external" href="http://www.imagemagick.org/script/convert.php">ImageMagick convert</a> using the command:</p>
<div class="highlight-python"><div class="highlight"><pre>convert -density 200 annotated_tree.pdf annotated_tree.jpg
</pre></div>
</div>
<p>The tree images created by these steps are shown below:</p>
<blockquote>
<div><blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Human_1918_Descended_GY94_codonPhyML_tree_annotated_tree.jpg"><img alt="GY94_codonPhyML_tree/annotated_tree.jpg" src="_images/example_2013Analysis_Influenza_NP_Human_1918_Descended_GY94_codonPhyML_tree_annotated_tree.jpg" style="width: 65%;" /></a>
<p class="caption">Image of the tree generated by <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> for the <em>GY94</em> substitution mdel (file <tt class="docutils literal"><span class="pre">./GY94_codonPhyML_tree/annotated_tree.jpg</span></tt>). In this tree, H2N2 is colored in red, H3N2 is colored in blue, seasonal H1N1 from the 1977 pandemic is colored in green, and all earlier H1N1 is colored in black.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Human_1918_Descended_KOSI07_codonPhyML_tree_annotated_tree.jpg"><img alt="KOSI07_codonPhyML_tree/annotated_tree.jpg" src="_images/example_2013Analysis_Influenza_NP_Human_1918_Descended_KOSI07_codonPhyML_tree_annotated_tree.jpg" style="width: 65%;" /></a>
<p class="caption">Image of the tree generated by <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> for the <em>KOSI07</em> substitution mdel (file <tt class="docutils literal"><span class="pre">./KOSI07_codonPhyML_tree/annotated_tree.jpg</span></tt>). In this tree, H2N2 is colored in red, H3N2 is colored in blue, seasonal H1N1 from the 1977 pandemic is colored in green, and all earlier H1N1 is colored in black.</p>
</div>
</div></blockquote>
<p>As can be seen from the above figures, the <em>GY94</em> and <em>KOSI07</em> substitution models yield extremely similar tree topologies. This is probably because the extremely dense sampling of the phylogeny makes it easy to place nodes.</p>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="construction-of-experimental-substitution-models">
<h3><a class="toc-backref" href="#id10">Construction of experimental substitution models</a><a class="headerlink" href="#construction-of-experimental-substitution-models" title="Permalink to this headline">¶</a></h3>
<p>Experimental codon substitution models usable by <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> were constructed from the equilibrium preferences inferred by the <a class="reference external" href="http://jbloom.github.io/mapmuts/example_2013Analysis_Influenza_NP_Aichi68.html">mapmuts analysis of the Aichi68 influenza NP from 2013</a>. Recall that the <a class="reference internal" href="#input-files">Input files</a> include the following three files giving experimentally inferred equilibrium preferences:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">replicate_A_p1_equilibriumpreferences.txt</span></tt></li>
<li><tt class="docutils literal"><span class="pre">replicate_B_p1_equilibriumpreferences.txt</span></tt></li>
<li><tt class="docutils literal"><span class="pre">p1_equilibriumpreferences.txt</span></tt></li>
</ul>
</div></blockquote>
<p>as well as as the <tt class="docutils literal"><span class="pre">mutspectrum.txt</span></tt> file giving the experimentally measured nucleotide mutation frequencies.</p>
<p>The experimental codon models are constructed with the <tt class="docutils literal"><span class="pre">phyloExpCM_buildHyphyExpCM.py</span></tt> script described in the <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a>. The models are constructed to be reversible, are created from the amino acid preferences using either the <em>FracTolerated</em> or the <em>HalpernBruno</em> approach described in the <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a> for <tt class="docutils literal"><span class="pre">phyloExpCM_buildHyphyExpCM.py</span></tt>.</p>
<p>The experimental models are constructed in the subdirectory <tt class="docutils literal"><span class="pre">./experimental_substitution_models/</span></tt>. Specifically, the following files are created in this directory
for each of the three amino-acid preference sets (<em>replicate A</em>, <em>replicate B</em>, and <em>combined</em>). The names below are for the one for the <em>combined</em> preferences; the names for <em>replicate A</em> and <em>replicate B</em> have the prefix <tt class="docutils literal"><span class="pre">combined_</span></tt> replaced with <tt class="docutils literal"><span class="pre">replicate_A_</span></tt> or <tt class="docutils literal"><span class="pre">replicate_B_</span></tt>:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">./experimental_substitution_models/combined_FracTolerated.ibf</span></tt> contains the codon substitution model using the <em>FracTolerated</em> method in <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> format as described in the <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a> for <tt class="docutils literal"><span class="pre">phyloExpCM_buildHyphyExpCM.py</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">./experimental_substitution_models/combined_Halpern.ibf</span></tt> contains the codon substitution model using the <em>HalpernBruno</em> method in <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> format.</li>
<li><tt class="docutils literal"><span class="pre">./experimental_substitution_models/combined_FracTolerated_evolutionary_equilibriumfreqs.txt</span></tt> contains the expected equilibrium amino-acid frequencies for evolution governed by <em>FracTolerated</em> model with the mutation process described in <tt class="docutils literal"><span class="pre">mutspectrum.txt</span></tt>. This file is in the format described in the <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a> for <tt class="docutils literal"><span class="pre">phyloExpCM_buildHyphyExpCM.py</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">./experimental_substitution_models/combined_HalpernBruno_evolutionary_equilibriumfreqs.txt</span></tt> is the expected equilibrium frequencies for evolution governed by the <em>HalpernBruno</em> model.</li>
</ul>
</div></blockquote>
<p>Note that the <tt class="docutils literal"><span class="pre">*.ibf</span></tt> files are not actually included in the <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> repository <a class="reference external" href="https://github.com/jbloom/phyloExpCM">on GitHub</a> due to their large file size, but they can be regenerated with the commands here.</p>
<p>We also make a visual logo plot image of the expected equilibrium frequencies of the different amino acids during evolution. Note that these frequencies are <strong>different</strong> from the amino-acid preferences themselves described in the <a class="reference external" href="http://jbloom.github.io/mapmuts/example_2013Analysis_Influenza_NP_Aichi68.html">mapmuts analysis of the Aichi68 influenza NP from 2013</a>, since these evolutionary frequencies account for the structure of the genetic code and mutation frequencies (see the <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a> for <tt class="docutils literal"><span class="pre">phyloExpCM_buildHyphyExpCM.py</span></tt>). A visual plot is made for the <em>combined</em> experimental data using the <em>FracTolerated</em> model (as will be seen below, this appears to be the best model), and is in the file <tt class="docutils literal"><span class="pre">./experimental_substitution_models/combined_FracTolerated_evolutionarysite_preferences_logoplot.pdf</span></tt> as shown below:</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/example_2013Analysis_Influenza_NP_Human_1918_Descended_experimental_substitution_models_combined_FracTolerated_evolutionarysite_preferences_logoplot.jpg"><img alt="experimental_substitution_models/combined_FracTolerated_evolutionarysite_preferences_logoplot.jpg" src="_images/example_2013Analysis_Influenza_NP_Human_1918_Descended_experimental_substitution_models_combined_FracTolerated_evolutionarysite_preferences_logoplot.jpg" style="width: 80%;" /></a>
<p class="caption">The expected amino-acid frequencies during evolution, as shown in the plot <tt class="docutils literal"><span class="pre">./experimental_substitution_models/combined_FracTolerated_evolutionarysite_preferences_logoplot.pdf</span></tt>.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="optimizing-the-trees-with-various-substitution-models">
<h3><a class="toc-backref" href="#id11">Optimizing the trees with various substitution models</a><a class="headerlink" href="#optimizing-the-trees-with-various-substitution-models" title="Permalink to this headline">¶</a></h3>
<p>This is the heart of the analysis: to use various codon substitution models to optimize the branch lengths and likelihood for the tree topologies estimated with <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> and the <em>GY94</em> or <em>KOSI07</em> substitution models as described in <a class="reference internal" href="#construction-of-phylogenetic-trees">Construction of phylogenetic trees</a>. This analysis compares the experimentally determined codon substitution models with various other substitution models.</p>
<p>This analysis is done with the <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> script <tt class="docutils literal"><span class="pre">phyloExpCM_optimizeHyphyTree.py</span></tt>, which is described in the <a class="reference external" href="http://jbloom.github.io/phyloExpCM">phyloExpCM documentation</a>. This script uses <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> to optimize the branch lengths and any substitution model free parameters on fixed tree topologies (the topologies estimated with <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> using the <em>GY94</em> or <em>KOSI07</em> models).</p>
<p>The results of the optimizations for the various substitution models are in the subdirectory <tt class="docutils literal"><span class="pre">./codonmodel_optimized_trees/</span></tt>. Within this subdirectory are further subdirectories containing the results of optimizing the branch lengths with <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> using the indicated codon substitution models. For example, <tt class="docutils literal"><span class="pre">./codonmodel_optimized_trees/Tree-KOSI07_Model-KOSI07_F_omega-global-gamma4_rates-one/</span></tt> contains one such model. Within this subdirectory, the files of interest are:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">hyphy_tree.newick</span></tt> is the tree with branch lengths optimized by <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> using the substitution model in question.</li>
<li><tt class="docutils literal"><span class="pre">hyphy_output.txt</span></tt> is a text file summarizing the <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> output from the optimization. Note that the <tt class="docutils literal"><span class="pre">hyphy_output.txt</span></tt> files are not actually included in the <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> repository <a class="reference external" href="https://github.com/jbloom/phyloExpCM">on GitHub</a> due to their large file size, but they can be regenerated using the commands here.</li>
</ul>
</div></blockquote>
<p>A more helpful way to view the results is to look at the main summary files created in the examples home directory. These files are <tt class="docutils literal"><span class="pre">KOSI07_summary.csv</span></tt> (for optimization of the tree topology estimated by <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> with the <em>KOSI07</em> model) and <tt class="docutils literal"><span class="pre">GY94_summary.csv</span></tt> (for optimization of the tree topology estimated by <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> with the <em>GY94</em> model). The results are sorted by the likelihood from best to worst.
Overall, this file contains the following columns:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Description of the substitution model.</p>
</li>
<li><p class="first">The difference in <a class="reference external" href="http://en.wikipedia.org/wiki/Akaike_information_criterion">AIC</a> from the best model.</p>
</li>
<li><p class="first">The log likelihood.</p>
</li>
<li><p class="first">The total number of free parameters in the substitution model. This is the sum of the parameters optimized by maximum likelihood and the parameters estimated empirically from the data.</p>
</li>
<li><p class="first">The total number of parameters in the substitution model optimized by maximum likelihood:</p>
<blockquote>
<div><ul class="simple">
<li>For experimental models, this is zero.</li>
<li>For <em>GY94</em> and <em>KOSI07</em> models, this are always at least two, as both <em>omega</em> and <em>kappa</em> are estimated by maximum likelihood. For some of the variants, <em>omega</em> is drawn from discrete gamma, beta, or discrete category distributions, which adds additional parameters. For some of the variants, the rate is drawn from discrete gamma categories, which also adds another parameter. Finally, for some of the variants <em>omega</em> is different for each branch, which adds a number of free parameters equal to the number of branches.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The total number of parameters in the substitution model that are empirically estimated from the sequence data:</p>
<blockquote>
<div><ul class="simple">
<li>For experimental models, this is zero.</li>
<li>For <em>GY94</em> models, this is 9 as in the <a class="reference external" href="http://www.plosone.org/article/info%3Adoi/10.1371/journal.pone.0011230">CF3x4</a> model there are a total of three independent frequencies for each of the three codon positions.</li>
<li>For <em>KOSI07</em> models, this is 60 as there are a total of 60 independent frequencies for the 61 non-stop codons.</li>
</ul>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<p>Here are the results for optimization of the tree built with the <em>GY94</em> model in <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> (this is the file <tt class="docutils literal"><span class="pre">GY94_summary.csv</span></tt>):</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre>#Summary for tree GY94.
#
#SUBSTITUTION_MODEL, dAIC, LOG_LIKELIHOOD, FREE_PARAMETERS, MAXIMUM_LIKELIHOOD_PARAMETERS, EMPIRICAL_PARAMETERS
combined_FracTolerated, 0, -12338.9, 0, 0, 0
replicate_A_FracTolerated, 67.8835, -12372.8, 0, 0, 0
replicate_B_FracTolerated, 106.1, -12392, 0, 0, 0
combined_HalpernBruno, 357.942, -12517.9, 0, 0, 0
replicate_A_HalpernBruno, 393.026, -12535.4, 0, 0, 0
replicate_B_HalpernBruno, 455.526, -12566.7, 0, 0, 0
GY94_CF3x4_M8_rates-one, 1136.82, -12893.3, 14, 5, 9
GY94_CF3x4_M2a_rates-one, 1209.52, -12929.7, 14, 5, 9
GY94_CF3x4_omega-global-gamma4_rates-one, 1217.97, -12935.9, 12, 3, 9
GY94_CF3x4_omega-global-one_rates-gamma4, 1485.75, -13069.8, 12, 3, 9
KOSI07_F_M2a_rates-one, 1679.73, -13113.8, 65, 5, 60
KOSI07_F_M8_rates-one, 1680.47, -13114.1, 65, 5, 60
GY94_CF3x4_omega-global-one_rates-one, 1754.13, -13205, 11, 2, 9
KOSI07_F_omega-global-gamma4_rates-one, 1757.71, -13154.8, 63, 3, 60
KOSI07_F_omega-global-one_rates-gamma4, 1831.13, -13191.5, 63, 3, 60
GY94_CF3x4_omega-branchlocal-one_rates-gamma4, 1972.31, -12769.1, 556, 547, 9
KOSI07_F_omega-global-one_rates-one, 2254.2, -13404, 62, 2, 60
KOSI07_F_omega-branchlocal-one_rates-gamma4, 2319.53, -12891.7, 607, 547, 60
randomize1_combined_FracTolerated, 3740.99, -14209.4, 0, 0, 0
randomize1_replicate_A_FracTolerated, 3809.56, -14243.7, 0, 0, 0
randomize1_replicate_B_FracTolerated, 3840.41, -14259.1, 0, 0, 0
randomize1_combined_HalpernBruno, 4388.74, -14533.3, 0, 0, 0
randomize1_replicate_B_HalpernBruno, 4559.13, -14618.5, 0, 0, 0
randomize1_replicate_A_HalpernBruno, 4622.09, -14649.9, 0, 0, 0
</pre></div>
</div>
</div></blockquote>
<p>Here are the results for optimization of the tree built with the <em>KOSI07</em> model in <a class="reference external" href="http://sourceforge.net/projects/codonphyml/">codonPhyML</a> (this is the file <tt class="docutils literal"><span class="pre">KOSI07_summary.csv</span></tt>):</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre>#Summary for tree KOSI07.
#
#SUBSTITUTION_MODEL, dAIC, LOG_LIKELIHOOD, FREE_PARAMETERS, MAXIMUM_LIKELIHOOD_PARAMETERS, EMPIRICAL_PARAMETERS
combined_FracTolerated, 0, -12334.6, 0, 0, 0
replicate_A_FracTolerated, 67.859, -12368.5, 0, 0, 0
replicate_B_FracTolerated, 106.183, -12387.7, 0, 0, 0
combined_HalpernBruno, 356.834, -12513, 0, 0, 0
replicate_A_HalpernBruno, 391.495, -12530.3, 0, 0, 0
replicate_B_HalpernBruno, 454.805, -12562, 0, 0, 0
GY94_CF3x4_M8_rates-one, 1183.43, -12912.3, 14, 5, 9
GY94_CF3x4_M2a_rates-one, 1209.41, -12925.3, 14, 5, 9
GY94_CF3x4_omega-global-gamma4_rates-one, 1219.56, -12932.4, 12, 3, 9
GY94_CF3x4_omega-global-one_rates-gamma4, 1493.09, -13069.1, 12, 3, 9
KOSI07_F_M2a_rates-one, 1675.96, -13107.6, 65, 5, 60
KOSI07_F_M8_rates-one, 1676.62, -13107.9, 65, 5, 60
KOSI07_F_omega-global-gamma4_rates-one, 1753.29, -13148.2, 63, 3, 60
GY94_CF3x4_omega-global-one_rates-one, 1762.2, -13204.7, 11, 2, 9
KOSI07_F_omega-global-one_rates-gamma4, 1834.26, -13188.7, 63, 3, 60
GY94_CF3x4_omega-branchlocal-one_rates-gamma4, 1980.84, -12769, 556, 547, 9
KOSI07_F_omega-global-one_rates-one, 2256.76, -13401, 62, 2, 60
KOSI07_F_omega-branchlocal-one_rates-gamma4, 2324.05, -12889.6, 607, 547, 60
randomize1_combined_FracTolerated, 3741.27, -14205.2, 0, 0, 0
randomize1_replicate_A_FracTolerated, 3809.45, -14239.3, 0, 0, 0
randomize1_replicate_B_FracTolerated, 3841.42, -14255.3, 0, 0, 0
randomize1_combined_HalpernBruno, 4387.56, -14528.4, 0, 0, 0
randomize1_replicate_B_HalpernBruno, 4557.92, -14613.6, 0, 0, 0
randomize1_replicate_A_HalpernBruno, 4620.76, -14645, 0, 0, 0
</pre></div>
</div>
</div></blockquote>
<p>Similar files are created in LaTex formatted tables as <tt class="docutils literal"><span class="pre">GY94_summary.tex</span></tt> and <tt class="docutils literal"><span class="pre">KOSI07_summary.tex</span></tt>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2013 analysis of human influenza NPs descended from 1918 virus</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#software-used">Software used</a></li>
<li><a class="reference internal" href="#input-files">Input files</a></li>
<li><a class="reference internal" href="#running-the-analysis">Running the analysis</a></li>
<li><a class="reference internal" href="#steps-in-the-analysis">Steps in the analysis</a><ul>
<li><a class="reference internal" href="#creation-of-sequence-alignments">Creation of sequence alignments</a></li>
<li><a class="reference internal" href="#check-for-outlier-sequences">Check for outlier sequences</a></li>
<li><a class="reference internal" href="#construction-of-phylogenetic-trees">Construction of phylogenetic trees</a></li>
<li><a class="reference internal" href="#construction-of-experimental-substitution-models">Construction of experimental substitution models</a></li>
<li><a class="reference internal" href="#optimizing-the-trees-with-various-substitution-models">Optimizing the trees with various substitution models</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.html"
                        title="previous chapter">Examples</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="example_2014Analysis_lactamase.html"
                        title="next chapter">2014 analysis of beta-lactamase phylogenetic fit</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/example_2013Analysis_Influenza_NP_Human_1918_Descended.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="example_2014Analysis_lactamase.html" title="2014 analysis of beta-lactamase phylogenetic fit"
             >next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >previous</a> |</li>
        <li><a href="index.html">phyloExpCM 0.2 documentation</a> &raquo;</li>
          <li><a href="examples.html" >Examples</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Jesse D. Bloom.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3a0.
    </div>
  </body>
</html>