<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>phyloExpCM_FreqsFromAlignment.py &mdash; phyloExpCM 0.3 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="phyloExpCM 0.3 documentation" href="index.html" />
    <link rel="up" title="Scripts" href="scripts.html" />
    <link rel="next" title="phyloExpCM_SiteLikelihoodComparison.py" href="phyloExpCM_SiteLikelihoodComparison.html" />
    <link rel="prev" title="phyloExpCM_ExpModelOptimizeHyphyTree.py" href="phyloExpCM_ExpModelOptimizeHyphyTree.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_SiteLikelihoodComparison.html" title="phyloExpCM_SiteLikelihoodComparison.py"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_ExpModelOptimizeHyphyTree.html" title="phyloExpCM_ExpModelOptimizeHyphyTree.py"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phyloExpCM 0.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="scripts.html" accesskey="U">Scripts</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="phyloexpcm-freqsfromalignment-py">
<span id="id1"></span><h1>phyloExpCM_FreqsFromAlignment.py<a class="headerlink" href="#phyloexpcm-freqsfromalignment-py" title="Permalink to this headline">¶</a></h1>
<p>This simple script gets the frequencies of amino acids at each site from a sequence
alignment. It then writes them to a format equivalent to that of the <code class="docutils literal"><span class="pre">*_equilibriumpreferences.txt</span></code> files produced by the <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> script <code class="docutils literal"><span class="pre">mapmuts_inferpreferences.py</span></code>.</p>
<p>Typically you would want to run this script if you wanted to create a file giving the amino-acid frequencies in an alignment of sequences that could be analyzed with the <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> scripts <code class="docutils literal"><span class="pre">mapmuts_siteprofileplots.py</span></code> or <code class="docutils literal"><span class="pre">mapmuts_preferencescorrelate.py</span></code>.</p>
<p>To run the script, create an input file of the format described below. Then run the script followed by the input file, as in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">phyloExpCM_FreqsFromAlignment</span><span class="o">.</span><span class="n">py</span> <span class="n">infile</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<div class="section" id="format-of-the-input-file">
<h2>Format of the input file<a class="headerlink" href="#format-of-the-input-file" title="Permalink to this headline">¶</a></h2>
<p>The input file specifies <cite>key</cite> / <cite>value</cite> pairs on individual lines in the format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">key1</span> <span class="n">value1</span>
<span class="n">key2</span> <span class="n">value2</span>
</pre></div>
</div>
<p>Blank lines or lines
that begin with # are ignored (i.e. as comment lines).</p>
<p>The input file should contain the following keys:</p>
<ul>
<li><p class="first"><em>alignmentfile</em> : the name of a file containing the aligned sequences. These sequences must all be aligned (of the same length). They should either be proteins or translatable DNA sequences depending on the value of <em>translateseqs</em>. This file should be in FASTA format.</p>
</li>
<li><p class="first"><em>translateseqs</em> : specifies whether we translate the sequences in <em>alignmentfile</em>. If <em>False</em> then the sequences in <em>alignmentfile</em> are assumed to already be protein sequences. If <em>True</em>, then the sequences in <em>alignmentfile</em> must be translatable DNA sequences. Gap codons (<code class="docutils literal"><span class="pre">---</span></code>) are translated to a <code class="docutils literal"><span class="pre">-</span></code> character, stop codons to a <code class="docutils literal"><span class="pre">*</span></code> character. In this latter case, the analysis is done on these translated sequences. An error is raised if the sequences cannot be translated.</p>
</li>
<li><p class="first"><em>includestop</em> : specifies whether we tally the frequencies of stop codons as a possible amino acid. If <em>True</em> then we include stop codons in the tally; if <em>False</em> then we do not.</p>
</li>
<li><p class="first"><em>pseudocounts</em> : integer number of pseudocounts added to the counts for each amino acid at each site. If you set this to zero, the actual fractions will be computed. But you might want to use a pseudocount (such as one) if you don&#8217;t want to estimate zero frequencies.</p>
</li>
<li><p class="first"><em>outputfile</em> is the created file in form the of the <code class="docutils literal"><span class="pre">*_equilibriumpreferences.txt</span></code> file created by the <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> script <code class="docutils literal"><span class="pre">mapmuts_inferpreferences.py</span></code>. Specifically, for each site all the occurrences of each amino acid is counted. Gaps are disregarded, and stop codons are either included or disregarded depending on the value of <em>includestop</em>. For each site <em>r</em> the script counts the fraction of sequences (among those being counted at this site) that have <em>a</em> as the amino acid. The results are written to the create file as in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#SITE   WT_AA   SITE_ENTROPY    PI_A    PI_C    PI_D    PI_E    PI_F    PI_G    PI_H    PI_I    PI_K    PI_L    PI_M    PI_N    PI_P    PI_Q    PI_R    PI_S    PI_T    PI_V    PI_W    PI_Y    PI_*</span>
<span class="mi">1</span>   <span class="n">na</span>   <span class="mf">2.85229</span> <span class="mf">0.0113803</span>   <span class="mf">0.0402777</span>   <span class="mf">0.0153121</span>   <span class="mf">0.0320438</span>   <span class="mf">0.013312</span>    <span class="mf">0.00936795</span>  <span class="mf">0.026916</span>    <span class="mf">0.0192017</span>   <span class="mf">0.0224047</span>   <span class="mf">0.018926</span>    <span class="mf">0.554093</span>    <span class="mf">0.0445008</span>   <span class="mf">0.0138125</span>   <span class="mf">0.0212192</span>   <span class="mf">0.0131771</span>   <span class="mf">0.0152268</span>   <span class="mf">0.0237621</span>   <span class="mf">0.0102606</span>   <span class="mf">0.0369008</span>   <span class="mf">0.0367991</span>   <span class="mf">0.0211056</span>
<span class="mi">2</span>   <span class="n">na</span>   <span class="mf">0.968359</span>    <span class="mf">0.878703</span>    <span class="mf">0.00384431</span>  <span class="mf">0.00390501</span>  <span class="mf">0.00815666</span>  <span class="mf">0.0048199</span>   <span class="mf">0.00244426</span>  <span class="mf">0.00333017</span>  <span class="mf">0.00258064</span>  <span class="mf">0.00391181</span>  <span class="mf">0.00094265</span>  <span class="mf">0.0248087</span>   <span class="mf">0.00238593</span>  <span class="mf">0.00064321</span>  <span class="mf">0.00288323</span>  <span class="mf">0.00610788</span>  <span class="mf">0.0012339</span>   <span class="mf">0.001455</span>    <span class="mf">0.0290568</span>   <span class="mf">0.0107545</span>   <span class="mf">0.00492073</span>  <span class="mf">0.00311186</span>
<span class="mi">3</span>   <span class="n">na</span>   <span class="mf">2.93851</span> <span class="mf">0.0295947</span>   <span class="mf">0.00304848</span>  <span class="mf">0.00227603</span>  <span class="mf">0.00668501</span>  <span class="mf">0.131168</span>    <span class="mf">0.000710502</span> <span class="mf">0.0199653</span>   <span class="mf">0.00804841</span>  <span class="mf">0.000619715</span> <span class="mf">0.366698</span>    <span class="mf">0.0132841</span>   <span class="mf">0.0223199</span>   <span class="mf">0.0048327</span>   <span class="mf">0.0170484</span>   <span class="mf">0.00875982</span>  <span class="mf">0.090712</span>    <span class="mf">0.0171888</span>   <span class="mf">0.0102176</span>   <span class="mf">0.177257</span>    <span class="mf">0.069395</span>    <span class="mf">0.000170873</span>
</pre></div>
</div>
<p>In this file, the <code class="docutils literal"><span class="pre">SITE_ENTROPY</span></code> column gives the site entropy taken to the base 2.</p>
<p>In this file, all of the wildtype identities (<code class="docutils literal"><span class="pre">WT_AA</span></code>) are set to <code class="docutils literal"><span class="pre">na</span></code> because there is no wildtype in the sequence alignment.</p>
<p>In this file, residues are numbered sequentially starting with one according to the aligned sequences in <em>alignmentfile</em>.</p>
<p>Note that if <em>averagesites</em> is set to <em>True</em>, then the fractions for each site <em>r</em> will be identical, and will represent the average over the entire length of the sequence.</p>
</li>
<li><p class="first"><em>requiresubstring</em> is an optional argument. If it is not specified or set to <em>None</em> then nothing is done. Otherwise, it should be set to a substring &#8211; in this case, we only compute the frequencies from sequences in <em>alignmentfile</em> that have headers that contain the substring specified by <em>requiresubstring</em>. For instance, if this substring is <em>HOST_Swine</em> then only sequences with headers that contain <em>HOST_swine</em> are counted. Note that if no sequences in <em>alignmentfile</em> contain headers with this substring, an error will be raised.</p>
</li>
<li><p class="first"><em>averagesites</em> is an optional Boolean switch. If it is not specified or set to <em>False</em>, then nothing is done. If you specify this option as <em>True</em>, then the fractions are <strong>averaged over all sites</strong>, and include the total number of occurrences of each amino acid at every site over all of the sequences. The pseudocounts specified by <em>pseudocounts</em> are then added to these total occurrences of amino acids at all sites. In this case, the reported fractions for each site in <em>outputfile</em> will be identical, since each is just reported as the average of all sites.</p>
</li>
</ul>
</div>
<div class="section" id="example-input-file">
<h2>Example input file<a class="headerlink" href="#example-input-file" title="Permalink to this headline">¶</a></h2>
<p>Here is an example input file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Example input file for phyloExpCM_FreqsFromAlignment.py</span>
<span class="n">alignmentfile</span> <span class="n">cds_sequences</span><span class="o">.</span><span class="n">fasta</span>
<span class="n">translateseqs</span> <span class="kc">True</span>
<span class="n">includestop</span> <span class="kc">False</span>
<span class="n">pseudocounts</span> <span class="mi">1</span>
<span class="n">outputfile</span> <span class="n">aminoacid_frequencies</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div>
<div class="section" id="output-files">
<h2>Output files<a class="headerlink" href="#output-files" title="Permalink to this headline">¶</a></h2>
<p>Some summary output is printed to standard output. In addition, the file specified by <em>outputfile</em> is created with the format described above in the documentation for the <em>outputfile</em> specification.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">phyloExpCM_FreqsFromAlignment.py</a><ul>
<li><a class="reference internal" href="#format-of-the-input-file">Format of the input file</a></li>
<li><a class="reference internal" href="#example-input-file">Example input file</a></li>
<li><a class="reference internal" href="#output-files">Output files</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="phyloExpCM_ExpModelOptimizeHyphyTree.html"
                        title="previous chapter">phyloExpCM_ExpModelOptimizeHyphyTree.py</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="phyloExpCM_SiteLikelihoodComparison.html"
                        title="next chapter">phyloExpCM_SiteLikelihoodComparison.py</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/phyloExpCM_FreqsFromAlignment.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_SiteLikelihoodComparison.html" title="phyloExpCM_SiteLikelihoodComparison.py"
             >next</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_ExpModelOptimizeHyphyTree.html" title="phyloExpCM_ExpModelOptimizeHyphyTree.py"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phyloExpCM 0.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="scripts.html" >Scripts</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Jesse D. Bloom.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.
    </div>
  </body>
</html>