<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>phyloExpCM_optimizeHyphyTree.py &mdash; phyloExpCM 0.3 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="phyloExpCM 0.3 documentation" href="index.html" />
    <link rel="up" title="Scripts" href="scripts.html" />
    <link rel="next" title="phyloExpCM_ExpModelOptimizeHyphyTree.py" href="phyloExpCM_ExpModelOptimizeHyphyTree.html" />
    <link rel="prev" title="phyloExpCM_buildHyphyExpCM.py" href="phyloExpCM_buildHyphyExpCM.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_ExpModelOptimizeHyphyTree.html" title="phyloExpCM_ExpModelOptimizeHyphyTree.py"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_buildHyphyExpCM.html" title="phyloExpCM_buildHyphyExpCM.py"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phyloExpCM 0.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="scripts.html" accesskey="U">Scripts</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="phyloexpcm-optimizehyphytree-py">
<span id="id1"></span><h1>phyloExpCM_optimizeHyphyTree.py<a class="headerlink" href="#phyloexpcm-optimizehyphytree-py" title="Permalink to this headline">¶</a></h1>
<p>This script takes a tree of known topology and uses <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> to optimize the branch lengths and any substitution model parameters. It can use several common codon models as well as the experimentally based codon models with known mutation rates. However, for experimentally based evolutionary models it will often be more convenient to instead use the newer script <a class="reference internal" href="phyloExpCM_ExpModelOptimizeHyphyTree.html#phyloexpcm-expmodeloptimizehyphytree-py"><span class="std std-ref">phyloExpCM_ExpModelOptimizeHyphyTree.py</span></a> &#8211; and use of this latter script is necessary if the mutation rates are unknown.</p>
<p>This script has been tested with <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> versions 2.112*. This script uses several <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> include batch files (<code class="docutils literal"><span class="pre">*.ibf</span></code> files) that are distributed with the <a class="reference external" href="https://github.com/jbloom/phyloExpCM">phyloExpCM</a> package in the <code class="docutils literal"><span class="pre">./src/data/</span></code> subdirectory, and should be installed in a location that the script can find if you have installed this package as instructed. If <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> fails with messages about being unable to find included files, maybe this didn&#8217;t work.</p>
<p>To run the script, create an <a class="reference internal" href="#input-file">Input file</a>  as described below. Then run the script from the command line using the input file as the single argument, as in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">phyloExpCM_optimizeHyphyTree</span><span class="o">.</span><span class="n">py</span> <span class="n">infile</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Note that running this script may take quite a while if <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> takes a long time to run. <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> can also start to consume a lot of memory for relatively big input trees &#8211; so you may need to use a computer with a large amount of RAM.</p>
<p>Note that <strong>if you are running multiple versions of this script then you should place them in separate subdirectories</strong>. This is important because otherwise the scripts may create temporary files with the same names that interfere with / overwrite each other.</p>
<div class="section" id="input-file">
<h2>Input file<a class="headerlink" href="#input-file" title="Permalink to this headline">¶</a></h2>
<p>The input file specifies <cite>key</cite> / <cite>value</cite> pairs on individual lines in the format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">key1</span> <span class="n">value1</span>
<span class="n">key2</span> <span class="n">value2</span>
</pre></div>
</div>
<p>Blank lines or lines
that begin with # are ignored (i.e. as comment lines).</p>
<p>The input file should contain the following keys:</p>
<ul>
<li><p class="first"><em>hyphypath</em> should contain a command that can be used to run <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> in batch mode. If you have installed <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> in the current search path, this might be something like <code class="docutils literal"><span class="pre">HYPHYMP</span></code> or <code class="docutils literal"><span class="pre">HYPHYMP</span> <span class="pre">CPU=4</span></code> (the latter command specifying how many CPUs to use for this multi-thread version) or <code class="docutils literal"><span class="pre">HYPHYDEBUG</span></code>. If <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> is not installed in the current search path, you will need to specify a full path to the executable.</p>
</li>
<li><p class="first"><em>hyphycmdfile</em> is the name of the created <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> batch mode command file that is used to run <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> by this script.</p>
</li>
<li><p class="first"><em>hyphyoutfile</em> is the name of the created output file that gives the results of the <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> analysis.</p>
</li>
<li><p class="first"><em>hyphytreefile</em> is the name of the created output file containing the <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> optimized tree.</p>
</li>
<li><p class="first"><em>hyphydistancesfile</em> is the name of a created output file file that shows the pairwise distances between all pairs of sequences (those in <em>fastafile</em>). Note that these are <strong>not</strong> the distances from the created <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> tree in <em>hyphytreefile</em>. Rather, the substitution model has all parameters frozen to the maximum-likelihood values that are determined by <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> during the optimization of <em>hyphytreefile</em>. With these optimized substitution model parameters fixed, <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> is then used to estimate the maximum likelihood pairwise distance between each pair of sequences (essentially, the branch length between them in a two-sequence tree). These pairwise distances are then written <em>hyphydistancesfile</em> in the format described in the <a class="reference internal" href="#output-files">Output files</a> section below. If you do not want to estimate pairwise distances, then set <em>hyphydistancesfile</em> to <em>None</em>.</p>
<p>Also, note that <strong>pairwise distances can ony be calculated for substitution models in which all parameters are global</strong> to all branches (the reason is that the model parameters cannot all be fixed if they are branch local). So if you are using a substitution model with local branch lengths (for instance <em>GY94_CF3x4_omega-branchlocal-one_rates-gamma6</em>), then no pairwise distances can be calculated. In this case, no <em>hyphydistancesfile</em> will be created regardless of whether you specify <em>None</em> or no file name.</p>
<p>It is also possible to use <em>hyphydistancesfile</em> to calculate pairwise distances to only certain sequences in <em>fastafile</em>. This can be particularly advantageous when using one of the <em>experimental</em> codon models (specified by the <em>models</em> parameter). The reason is that <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> can take a long time to calculate pairwise distances for <em>experimental</em> codon models. If you only want to calculate pairwise distances to certain sequences, then include the name of these sequences following they <em>hyphydistancesfile</em> key and the file to be created, as in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">hyphydistancesfile</span> <span class="n">hyphy_distances</span><span class="o">.</span><span class="n">txt</span> <span class="n">A</span><span class="o">/</span><span class="n">Brevig_Mission</span><span class="o">/</span><span class="mi">1918</span><span class="n">_</span><span class="p">(</span><span class="n">H1N1</span><span class="p">)</span> <span class="n">A</span><span class="o">/</span><span class="n">Brisbane</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="mi">2007</span><span class="n">_</span><span class="p">(</span><span class="n">H3N2</span><span class="p">)</span>
</pre></div>
</div>
<p>The aforegoing line would cause the script to create the file <em>hyphy_distances.txt</em>, but that file would only include pairwise distances to the two indicated sequences from all other sequences in the file (so if there are <em>N</em> sequences there would be <em>2N - 1</em> distances). Note that the names of the sequences that are specified must exactly match full headers in <em>fastafile</em> or an exception is raised.</p>
<p>Note also that neither the name of the file specified by <em>hyphydistancesfile</em> or any of the specified sequences can contain spaces.</p>
</li>
<li><p class="first"><em>fastafile</em> is the name of a FASTA file containing the sequences that comprise the tip nodes. These should be nucleotide coding sequences aligned at the codon level (not at the nucleotide level). Stop codons should be removed, and the aligned sequence length should be a multiple of three. Ambiguous nucleotide identities are not supported. The headers for the sequences should match the names of the tip nodes in <em>treefile</em>.</p>
</li>
<li><p class="first"><em>treefile</em> is a Newick-format phylogenetic tree giving the relationship among the sequences in <em>fastafile</em>. The names of the tip nodes must match those in <em>fastafile</em>. Branch lengths can be specified, but they will be optimized by <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a>. Branch supports can be present, but they are ignored and removed in the output tree.</p>
</li>
<li><p class="first"><em>siteslist</em> is the name of a file that specifies all of the codon sites that are included in the analysis in 1, 2, ... numbering. The first line of this file should be a header beginning with a <em>#</em> character, and is skipped. The remaining lines should begin with an integer &gt;= 1 that gives a site number, followed by whitespace &#8211; anything following this whitespace is ignored. All of the numbers in this first column are taken to be the numbers of the codon sites included. You can use the <code class="docutils literal"><span class="pre">*_equilibriumpreferences.txt</span></code> file generated by the <a class="reference external" href="https://github.com/jbloom/mapmuts">mapmuts</a> script <code class="docutils literal"><span class="pre">mapmuts_inferpreferences.py</span></code> and used as input to <a class="reference internal" href="phyloExpCM_buildHyphyExpCM.html#phyloexpcm-buildhyphyexpcm-py"><span class="std std-ref">phyloExpCM_buildHyphyExpCM.py</span></a> as the value for this argument, since it satisfies these formatting requirements.</p>
</li>
<li><p class="first"><em>model</em> specifies the codon substitution model used by <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a>. Valid values are:</p>
<blockquote>
<div><ul>
<li><p class="first"><em>experimental hyphyExpCMs.ibf</em> specifies that we use an experimentally determined codon model. The first part of this value (the string <em>experimental</em>) indicates that we are using an experimentally determined model. The second part of this value should be the name of a file (no spaces) that specifies the codon model in <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> batch format for each site in <em>sites</em>. Typically, this would have been generated using the <a class="reference internal" href="phyloExpCM_buildHyphyExpCM.html#phyloexpcm-buildhyphyexpcm-py"><span class="std std-ref">phyloExpCM_buildHyphyExpCM.py</span></a> script. This file either must exist in the current directory or you must provide a full path name, as the file will be included by <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> in its analysis.</p>
</li>
<li><p class="first"><em>experimental_randomize1 hyphyExpCMs.ibf</em> specifies that we use a experimentally determined codon model, but that we randomize the assignment of experimentally determined site models to different sites. This is done by randomly shuffling the position indices in the alignment. As a result, each site model will be assigned to some random site &#8211; not necessarily the one that is supposed to match. You would use this is a control. If the experimental models are good, we might expect them to perform well without randomization but poorly with randomization. For this option, the second argument again specifies the codon model in <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> batch file format for each site in <em>sites</em> as generated by <a class="reference internal" href="phyloExpCM_buildHyphyExpCM.html#phyloexpcm-buildhyphyexpcm-py"><span class="std std-ref">phyloExpCM_buildHyphyExpCM.py</span></a>. The number after <em>randomize</em> in the first argument is the integer seed used to seed the random number generator &#8211; different seeds will give different results due to different randomization orders.</p>
</li>
<li><p class="first">A number of variants of the <a class="reference external" href="http://mbe.oxfordjournals.org/content/11/5/725.full.pdf">Goldman and Yang 1994</a> (GY94) codon model as delineated below.</p>
<p>The equilibrium codon frequencies are determined empirically from the frequencies of nucleotides at the three nucleotide positions using either the <a class="reference external" href="http://www.plosone.org/article/info%3Adoi/10.1371/journal.pone.0011230">CF3x4</a> or the F3x4 model. In general, the <a class="reference external" href="http://www.plosone.org/article/info%3Adoi/10.1371/journal.pone.0011230">CF3x4</a> model should be preferred unless you have a reason to use F3x4, since the former model corrects numerical inconsistencies with the latter.</p>
<p>The transition/transversion ratio <em>kappa</em> has one global value applied to all sites and branches which is estimated by maximum likelihood.</p>
<p>The non-synonymous / synonymous substitution rate ratio <em>omega</em> can be set to either be <em>global</em> so that it is shared among all branches, or can be set to be <em>branchlocal</em> so that each branch has its own value of <em>omega</em>. Taking the branch local approach will obviously greatly increase the number of parameters. In addition, for both <em>global</em> and <em>branchlocal</em>, it can be set to <em>one</em> for one ratio, or <em>gamma</em> with an integer indicating the number of rate categories (such as <em>gamma6</em>) drawn from a discrete gamma distribution as originally described in <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/7932792">Yang 1994</a>.</p>
<p>In addition, there can be rate variation across sites. Currently, it is only supported to allow rate variation where the rates are drawn with equal probability from a discrete gamma distribution as originally described in <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/7932792">Yang 1994</a>. The gamma distribution alpha parameter is estimated by maximum likelihood. This is specified by the word <em>rates</em> followed by <em>one</em> if there is only one rate (no rate variation). Otherwise <em>rates</em> is followed by <em>gamma</em> with an integer indicating the number of rate categories, such as <em>gamma6</em> (probably a good value).</p>
<p>Based on these descriptions, here are some valid model specification strings (other combination also are allowed following this format):</p>
<blockquote>
<div><ul class="simple">
<li><em>GY94_CF3x4_omega-global-one_rates-one</em> is <a class="reference external" href="http://www.plosone.org/article/info%3Adoi/10.1371/journal.pone.0011230">CF3x4</a> model for equilibrium codon frequencies, one global <em>omega</em> (dN/dS) ratio, and one rate for all sites.</li>
<li><em>GY94_CF3x4_omega-global-one_rates-gamma6</em> is <a class="reference external" href="http://www.plosone.org/article/info%3Adoi/10.1371/journal.pone.0011230">CF3x4</a> model of equilibrium codon frequencies, one global <em>omega</em> (dN/dS ratio), and rate variation across sites modeled by six categories drawn from a gamma distribution with the shape parameter estimated by maximum likelihood.</li>
<li><em>GY94_CF3x4_omega-global-gamma6_rates-one</em> is <a class="reference external" href="http://www.plosone.org/article/info%3Adoi/10.1371/journal.pone.0011230">CF3x4</a> model of equilibrium codon frequencies, an <em>omega</em> (dN/dS) ratio that is drawn from six gamma-distributed categories with both the mean and the shape estimated by maximum likelihood, and one rate for all sites.</li>
<li><em>GY94_CF3x4_omega-global-gamma6_rates-gamma6</em> is <a class="reference external" href="http://www.plosone.org/article/info%3Adoi/10.1371/journal.pone.0011230">CF3x4</a> model of equilibrium codon frequencies, an <em>omega</em> (dN/dS) ratio that is drawn from six gamma-distributed categories with both the mean and the shape estimated by maximum likelihood, and rate variation across sites drawn from six gamma-distributed categories with the shape prameter estimated by maximum likelihood.</li>
<li><em>GY94_CF3x4_omega-branchlocal-one_rates-gamma6</em> is like <em>GY94_CF3x4_omega-global-one_rates-gamma6</em> except now each branch gets its own single dN/dS ratio <em>omega</em> that is estimated by maximum likelihood.</li>
<li><em>GY94_CF3x4_M1a_rates-one</em> is the <em>M1a</em> model described by <a class="reference external" href="http://mbe.oxfordjournals.org/content/22/4/1107.full">Yang et al 2005</a>.</li>
<li><em>GY94_CF3x4_M2a_rates-one</em> is the <em>M2a</em> model described by <a class="reference external" href="http://mbe.oxfordjournals.org/content/22/4/1107.full">Yang et al 2005</a>.</li>
<li><em>GY94_CF3x4_M7_rates-one</em> is the <em>M7</em> model described by <a class="reference external" href="http://mbe.oxfordjournals.org/content/22/4/1107.full">Yang et al 2005</a> with 10 equal probability categories in the beta distribution.</li>
<li><em>GY94_CF3x4_M8_rates-one</em> is the <em>M8</em> model described by <a class="reference external" href="http://mbe.oxfordjournals.org/content/22/4/1107.full">Yang et al 2005</a> with 10 equal probability categories in the beta distribution plus one additional discrete category.</li>
</ul>
</div></blockquote>
<p>Note that it is NOT allowed to combined <em>branchlocal</em> with <em>gamma</em> for the <em>omega</em> as this introduces too many parameters. So the following would NOT be valid: <em>GY94_CF3x4_omega-branchlocal-gamma6_rates-one</em>.</p>
</li>
<li><p class="first">A number of variants of the KOSI07 empirical codon model described in <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/17400572">Kosiol et al, 2007</a>. That reference delineates a large list of model variants. The ones implemented here are all variants of what is described as the <em>ECM+F+omega+1kappa(tv)</em> in the original reference. Specifically, the codon exchangeabilities are those given by <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/17400572">Kosiol et al, 2007</a>, and allow multi as well as single-nucleotide codon changes. The equilibrium codon frequencies are empirically estimated as the frequencies in the data (the <em>+F</em> option). There is a parameter <em>omega</em> scaling non-synonymous substitution rates relative to synonymous rates. Codon changes with <em>ntv</em> transversions are scaled to a rate of <em>kappa^ntv</em> relative to mutations without transversions. Similarly to the <em>GY94</em> models, <em>omega</em> can be global to all branches with one estimated value, global to all branches with gamma distributed values, or local to branches with one estimated value per branch. The substitution rate can have a single value (no parameters in this case since it just involves branch length scaling) or have gamma distributed values with an estimated shape parameter. <em>kappa</em> is always global and estimated from the data. These options are specified with suffixes similar to the <em>GY94</em> model, such as:</p>
<blockquote>
<div><ul class="simple">
<li><em>KOSI07_F_omega-global-gamma6_rates-gamma6</em></li>
<li><em>KOSI07_F_omega-branchlocal-one_rates-one</em></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><em>persitelikelihoods</em> is an optional argument. If it is <em>None</em>, <em>False</em>, or not specified, the nothing is done. Otherwise, set it to the name of a file that you would like to create that reports the per-site likelihoods. Specifically, the created file lists the per-site likelihood for each site after the mutation rates and branch lengths have been optimized by maximum likelihood. These parameters and branch lengths are <strong>not</strong> re-optimized for each site &#8211; rather, they are set to their global best values and then the likelihood contribution of each site is computed. The per-site likelihoods are listed in tab-delimited columns with each site on a separate line, and the first column giving the site number and second giving the per-site likelihood. The first line in the file is a header.</p>
</li>
</ul>
</div>
<div class="section" id="example-input-file">
<h2>Example input file<a class="headerlink" href="#example-input-file" title="Permalink to this headline">¶</a></h2>
<p>Here is an example input file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Example input file for phyloExpCM_optimizeHyphyTree.py</span>
<span class="n">hyphypath</span> <span class="n">HYPHYMP</span> <span class="n">CPU</span><span class="o">=</span><span class="mi">4</span>
<span class="n">hyphycmdfile</span> <span class="n">hyphy_cmds</span><span class="o">.</span><span class="n">bf</span>
<span class="n">hyphyoutfile</span> <span class="n">hyphy_output</span><span class="o">.</span><span class="n">txt</span>
<span class="n">hyphytreefile</span> <span class="n">hyphy_tree</span><span class="o">.</span><span class="n">newick</span>
<span class="n">hyphydistancesfile</span> <span class="n">hyphy_distances</span><span class="o">.</span><span class="n">txt</span>
<span class="n">fastafile</span> <span class="n">Human_NPs</span><span class="o">.</span><span class="n">fasta</span>
<span class="n">treefile</span> <span class="n">Human_NPs_codonphyml_tree</span><span class="o">.</span><span class="n">newick</span>
<span class="n">siteslist</span> <span class="n">equilibriumpreferences</span><span class="o">.</span><span class="n">txt</span>
<span class="n">model</span> <span class="n">experimental</span> <span class="n">hyphyExpCMs_FracTolerated</span><span class="o">.</span><span class="n">ibf</span>
</pre></div>
</div>
</div>
<div class="section" id="output-files">
<h2>Output files<a class="headerlink" href="#output-files" title="Permalink to this headline">¶</a></h2>
<p>Some summary output is printed to standard output. In addition, the following output files are created. If any of these files already exist, they are overwritten:</p>
<ul>
<li><p class="first"><em>hyphycmdfile</em> is a <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> batch file that contains the commands used to run <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> in batch mode.</p>
</li>
<li><p class="first"><em>hyphyoutfile</em> is an output file that contains the results of the <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> analysis. This file may contain many lines dealing with branch lengths and tree topology that you will probably want to ignore in favor of just looking at <em>hyphytreefile</em>, but you will want to look at the first few lines of this file, which will have the following format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Log</span> <span class="n">likelihood</span><span class="p">:</span> <span class="o">-</span><span class="mf">671.317</span>
<span class="n">independent</span> <span class="n">parameters</span> <span class="p">(</span><span class="n">includes</span> <span class="n">branch</span> <span class="n">lengths</span><span class="p">):</span> <span class="mi">45</span>
<span class="n">shared</span> <span class="n">parameters</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">number</span> <span class="n">of</span> <span class="n">branch</span> <span class="n">lengths</span><span class="p">:</span> <span class="mi">45</span>
<span class="n">number</span> <span class="n">of</span> <span class="n">tip</span> <span class="n">nodes</span><span class="p">:</span> <span class="mi">24</span>
<span class="n">number</span> <span class="n">of</span> <span class="n">internal</span> <span class="n">branches</span><span class="p">:</span> <span class="mi">21</span>
</pre></div>
</div>
</li>
<li><p class="first"><em>hyphytreefile</em> is an output file that contains the tree with the <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> optimized branch lengths in Newick format. The branch lengths are <em>t</em> parameters from <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a>. For experimentally determined codon models, these are equal to the expected substitutions averaged over all sites. For GY94 models, these are proportional (not equal) to the expected number of substitutions at the site if <em>omega</em> is <em>global</em> but not if it is <em>branchlocal</em>. Any branch supports present in the original tree are removed.</p>
</li>
<li><p class="first"><em>hyphydistancesfile</em> is an output file that shows the pairwise distances between all sequences in <em>fastafile</em>. If there are <em>N</em> such sequences, then there are <span class="math">\(\frac{N (N-1)}{2}\)</span> pairwise distances, and so <em>hyphydistancesfile</em> contains this many lines. However, if specific headers are specified following <em>hyphdistancesfile</em> such that we only estimate distances for a few sequences, then there will be fewer lines &#8211; for instance, if two sequences are specified, then we have <em>2N - 1</em> distances. Each line has three entries:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The name of the first sequence (the full header in <em>fastafile</em>)</li>
<li>The name of the second sequence (the full header in <em>fastafile</em>)</li>
<li>The pairwise distance between the sequences.</li>
</ol>
</div></blockquote>
<p>These entries are separated by a tab.</p>
<p>For example, here are a few possible lines:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Sequence1</span>   <span class="n">Sequence2</span>    <span class="mf">0.800143</span>
<span class="n">Sequence1</span>   <span class="n">Sequence3</span>    <span class="mf">0.92947</span>
<span class="n">Sequence2</span>   <span class="n">Sequence3</span>    <span class="mf">2.13376</span>
</pre></div>
</div>
</li>
<li><p class="first">If you use the <em>persitelikelihoods</em> option, then an output file is created that shows the per-site likelihoods. The format is as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#SITE   SITE_LOG_LIKELIHOODS</span>
<span class="mi">1</span>   <span class="o">-</span><span class="mf">4.792906363107919</span>
<span class="mi">2</span>   <span class="o">-</span><span class="mf">15.89808216031635</span>
<span class="mi">3</span>   <span class="o">-</span><span class="mf">17.19022748421175</span>
</pre></div>
</div>
</li>
<li><p class="first">The script also creates several temporary files that re-map the sequences in <em>fastafile</em> and <em>treefile</em> to names that are usable by <a class="reference external" href="http://www.hyphy.org/w/index.php/Main_Page">HYPHY</a> (which only accepts alphanumeric characters and underscores). Specifically, these files begin with the prefix <em>_codenames_</em> and then are followed by suffixes which are the names of <em>fastafile</em>, <em>treefile</em>, and <em>hyphydistancesfile</em>. If the script terminates normally, these files are then deleted &#8211; but they will be present when the script is running, and will be preserved if it halts prematurely to aid in debugging.</p>
</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">phyloExpCM_optimizeHyphyTree.py</a><ul>
<li><a class="reference internal" href="#input-file">Input file</a></li>
<li><a class="reference internal" href="#example-input-file">Example input file</a></li>
<li><a class="reference internal" href="#output-files">Output files</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="phyloExpCM_buildHyphyExpCM.html"
                        title="previous chapter">phyloExpCM_buildHyphyExpCM.py</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="phyloExpCM_ExpModelOptimizeHyphyTree.html"
                        title="next chapter">phyloExpCM_ExpModelOptimizeHyphyTree.py</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/phyloExpCM_optimizeHyphyTree.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_ExpModelOptimizeHyphyTree.html" title="phyloExpCM_ExpModelOptimizeHyphyTree.py"
             >next</a> |</li>
        <li class="right" >
          <a href="phyloExpCM_buildHyphyExpCM.html" title="phyloExpCM_buildHyphyExpCM.py"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phyloExpCM 0.3 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="scripts.html" >Scripts</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, Jesse D. Bloom.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.
    </div>
  </body>
</html>